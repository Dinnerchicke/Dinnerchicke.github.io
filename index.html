<!DOCTYPE html>


<html lang="zh-CN">


<head>
  <meta name="baidu-site-verification" content="code-QdAXqd4Pi2" />
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/Logo.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

</head>

</html>

<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover2.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">CDX</a></h1>
      <div id="subtitle-box">
        
          <span id="subtitle">鲜衣怒马，恰似少年时</span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>




<!-- Subtitle -->

<div id="main">
  <section class="outer">
  
  <article class="articles">
    
    
    
    
    <article
  id="post-comShell"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/10/06/comShell/"
    >comShell
  <i class="article-topping">置顶</i>
</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/10/06/comShell/" class="article-date">
  <time datetime="2020-10-06T08:10:17.000Z" itemprop="datePublished">2020-10-06</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/devOps/">devOps</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Shell常用指令"><a href="#Shell常用指令" class="headerlink" title="Shell常用指令"></a>Shell常用指令</h1><p><img src="/2020/10/06/comShell/1.jpg"></p>
<h2 id="文件及命令"><a href="#文件及命令" class="headerlink" title="文件及命令"></a>文件及命令</h2><ul>
<li>cat 显示文件内容</li>
<li>cd ..返回上级目录 cd ../..返回上两级目录</li>
<li>pwd 显示工作路径</li>
<li>more 显示文件内容，空格向后，b向前</li>
<li>head 查看文件开头</li>
<li>tail 查看文件末尾</li>
<li>rm -f 文件名 删除文件</li>
<li>rm -rf 强制删除</li>
<li>cp file1 file2 复制文件</li>
<li>gzip 文件名/目录名 压缩后面文件或文件夹，-d解压</li>
<li>tail -f 文件名 跟踪文件的增长情况，-n显示文件尾部n行内容</li>
<li><em>ranger</em> 好使的浏览文件方法 gg顶部，G底部，g 定位，f查找，还支持鼠标点击！</li>
</ul>
<h2 id="系统常用"><a href="#系统常用" class="headerlink" title="系统常用"></a>系统常用</h2><ul>
<li>ls -s查看目录详细文件信息</li>
<li>sudo apt-get –purge remove <programname> 卸载软件</programname></li>
<li>top 查看当前系统中耗费资源最多进程</li>
<li>data 系统当前时间</li>
<li>ps -ax 查看所有进程</li>
<li>df -h 查看磁盘剩余资源</li>
<li>kill PID 杀死进程，-KILL强制杀死</li>
<li>ss -tlnp 查看哪些进程使用了监听端口</li>
<li>ps aux | grep java | grep -v grep 显示出所有java进程，处理当前grep进程(常用管道命令，grep处理字符串)</li>
<li>shutdown  -h now 关闭系统</li>
<li>strace 跟踪系统调用的执行，-p进程号，-c -p运行一段时间后停止获取数据，-o输出结果，-tt时刻调用，-y路径，-c调用次数等</li>
<li>netstat 统计网络相关协议数据</li>
<li>perf 系统性能分析</li>
<li>free -h 查看内存</li>
<li>dstat 综合分析，-c cpu，-d磁盘，-i 中断统计，-l负载均衡统计，-m内存统计，-n网络统计，-p 进程统计</li>
<li>reboot 重启</li>
<li>logout 注销</li>
</ul>
<h2 id="常用快捷键"><a href="#常用快捷键" class="headerlink" title="常用快捷键"></a>常用快捷键</h2><ul>
<li>Ctrl+c 终止进程</li>
<li>Ctrl+l  清屏</li>
<li>Ctrl+q 退出</li>
<li>/&gt; 将前面一条命令的输出写入到后面的文本中，文本清空后写入</li>
<li>/&gt;&gt; 同&gt;，文本不清空</li>
<li>| 管道命令，以前一个命令的输出作为输入运行，如cat 1.txt | grep ‘hello’ 打印1.txt中带有hello字符串的行</li>
</ul>
<h2 id="VIM"><a href="#VIM" class="headerlink" title="VIM"></a>VIM</h2><h3 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h3><ul>
<li>gg 跳到首行</li>
<li>G 跳到末行</li>
<li>:n 跳到n行</li>
</ul>
<h3 id="替换和取消命令"><a href="#替换和取消命令" class="headerlink" title="替换和取消命令"></a>替换和取消命令</h3><ul>
<li>u undo，取消上一步操作</li>
<li>Ctrl+r 返回到undo之前</li>
</ul>
<h3 id="删除命令"><a href="#删除命令" class="headerlink" title="删除命令"></a>删除命令</h3><ul>
<li>dd 删除光标所在行</li>
<li>dG 删除光标所在行到末尾行的所有内容</li>
<li>D 删除光标所在处到行尾的内容</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DevOps/" rel="tag">DevOps</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-AJAX"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/03/26/AJAX/"
    >AJAX</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/03/26/AJAX/" class="article-date">
  <time datetime="2021-03-26T08:23:24.000Z" itemprop="datePublished">2021-03-26</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/web-Design/">web-Design</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h1><blockquote>
<p>AJAX意为异步的JavaScript和XML</p>
</blockquote>
<blockquote>
<p>优点：</p>
<ol>
<li>可以无需刷新页面与服务器进行通信</li>
<li>允许你根据用户事件来更新部分页面内容</li>
</ol>
<p>缺点：</p>
<ol>
<li>没有浏览历史，不能回退</li>
<li>存在跨域问题</li>
<li>SEO不友好(页面是动态生成的)</li>
</ol>
</blockquote>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><blockquote>
<p>超文本传输协议，协议规定了浏览器和万维网服务器之间的通信规则</p>
</blockquote>
<h3 id="请求报文"><a href="#请求报文" class="headerlink" title="请求报文"></a>请求报文</h3><blockquote>
<p>行:</p>
<ul>
<li>请求方式(get/post…)</li>
<li>请求参数(s?ie=utf-8…)</li>
<li>HTTP版本1.1</li>
</ul>
<p>头:</p>
<ul>
<li>Host:baidu.com</li>
<li>Cookie:name=baidu</li>
<li>Content-type: application/x-www-form-urlencoded</li>
<li>User-Agent:chrome 83</li>
<li>…</li>
</ul>
<p>空行</p>
<p>体:(get请求体为空,post不为空)</p>
<ul>
<li>username=admin&amp;password=admin</li>
</ul>
</blockquote>
<h3 id="响应报文"><a href="#响应报文" class="headerlink" title="响应报文"></a>响应报文</h3><blockquote>
<p>行:</p>
<ul>
<li>HTTP版本(1.1)</li>
<li>状态码</li>
<li>状态码信息</li>
</ul>
<p>头:</p>
<ul>
<li>Content-Type:text/html;charset=urf-8</li>
<li>Content-length:2048</li>
<li>Content-encoding:gzip</li>
</ul>
<p>空行</p>
<p>体:如html … /html</p>
</blockquote>
<h2 id="原生AJAJ-API"><a href="#原生AJAJ-API" class="headerlink" title="原生AJAJ_API"></a>原生AJAJ_API</h2><h3 id="发送GET-POST请求"><a href="#发送GET-POST请求" class="headerlink" title="发送GET/POST请求"></a>发送GET/POST请求</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">// 状态1：创建AJAX</span></span><br><span class="line">   <span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">   <span class="comment">// 状态2：初始化</span></span><br><span class="line">   xhr.open(<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;http://127.0.0.1:9010/server?a=100&amp;b=200&#x27;</span>) <span class="comment">// get方法</span></span><br><span class="line">xhr.open(<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;http://127.0.0.1:9010/server&#x27;</span>) <span class="comment">//post方法</span></span><br><span class="line">   <span class="comment">// 状态3：发送</span></span><br><span class="line">   xhr.send() <span class="comment">//get直接send即可</span></span><br><span class="line">xhr.send(<span class="string">&#x27;a=100&amp;b=200&amp;c=300&#x27;</span>) <span class="comment">// post把参数放进send里面</span></span><br><span class="line">   <span class="comment">// 状态4：事件绑定,状态改变触发change事件，处理服务器返回的结果</span></span><br><span class="line">   xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="comment">// 判断状态为4，服务端返回了所有结果</span></span><br><span class="line">     <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">       <span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status&lt;<span class="number">300</span>) &#123;</span><br><span class="line">         <span class="comment">// 处理结果： 行/头/空行/体</span></span><br><span class="line">         <span class="comment">// 响应行内容获取</span></span><br><span class="line">         <span class="built_in">console</span>.log(<span class="string">&#x27;xhr.status&#x27;</span>,xhr.status)</span><br><span class="line">         <span class="built_in">console</span>.log(<span class="string">&#x27;xhr.statusText&#x27;</span>,xhr.statusText)</span><br><span class="line">         <span class="built_in">console</span>.log(<span class="string">&#x27;xhr.getAllResponseHeaders()&#x27;</span>,xhr.getAllResponseHeaders())</span><br><span class="line">         <span class="built_in">console</span>.log(<span class="string">&#x27;xhr.response&#x27;</span>,xhr.response)</span><br><span class="line">         <span class="comment">// 设置响应</span></span><br><span class="line">         div.innerText = xhr.response</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="请求超时-网络异常"><a href="#请求超时-网络异常" class="headerlink" title="请求超时/网络异常"></a>请求超时/网络异常</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 超时设置</span></span><br><span class="line">xhr.timeout = <span class="number">2000</span>;</span><br><span class="line"><span class="comment">// 超时回调</span></span><br><span class="line">xhr.ontimeout = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">&#x27;网络异常请稍后重试&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 网络异常回调</span></span><br><span class="line">xhr.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">&#x27;网络异常请稍后重试&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="取消重复发送的请求"><a href="#取消重复发送的请求" class="headerlink" title="取消重复发送的请求"></a>取消重复发送的请求</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> btnSend = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;btnSend&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> btnCancel = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;btnCancel&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> xhr</span><br><span class="line"><span class="keyword">let</span> isSending = <span class="literal">false</span> <span class="comment">// 请求标识符</span></span><br><span class="line">btnSend.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (isSending) &#123;</span><br><span class="line">    xhr.abort() <span class="comment">// 取消发送请求</span></span><br><span class="line">  &#125;</span><br><span class="line">  xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">  isSending = <span class="literal">true</span></span><br><span class="line">  xhr.open(<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;http://127.0.0.1:9010/delay&#x27;</span>)</span><br><span class="line">  xhr.send()</span><br><span class="line">  xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">      isSending = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">btnCancel.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  xhr.abort()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><blockquote>
<p>同源策略：协议、域名、端口完全相同</p>
<p>违反同源即跨域</p>
</blockquote>
<h3 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h3><blockquote>
<p>JSONP利用了<code>script标签</code>天生不受跨域限制的漏洞，不过只能使用<code>get</code>方法</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> script = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>)</span><br><span class="line">script.src = <span class="string">&#x27;跨域URL链接&#x27;</span></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(script)</span><br></pre></td></tr></table></figure>



<p>express后端代码：获取callback参数，执行callback对应的函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/jsonp-serverInput&#x27;</span>,<span class="function">(<span class="params">Request,Response</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> data = &#123;</span><br><span class="line">    exist: <span class="number">1</span>,</span><br><span class="line">    msg:<span class="string">&#x27;用户名已经存在&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> str = <span class="built_in">JSON</span>.stringify(data)</span><br><span class="line">  <span class="built_in">console</span>.log(Request.query)</span><br><span class="line">  <span class="keyword">let</span> callbackName = Request.query.callback</span><br><span class="line">  Response.send(<span class="string">`<span class="subst">$&#123;callbackName&#125;</span>(<span class="subst">$&#123;str&#125;</span>)`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><blockquote>
<p>因为跨域限制就是因为响应头</p>
<p>所以只需要<code>服务器</code>设置Access-Control-Allow-Origin响应头即可</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>,<span class="string">&quot;*&quot;</span>) <span class="comment">// 允许所有非同源</span></span><br><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>,<span class="string">&quot;*&quot;</span>) <span class="comment">// 允许所有头部字段</span></span><br><span class="line">response.setHeader(<span class="string">&quot;Access-Control-Allow-Method&quot;</span>,<span class="string">&quot;*&quot;</span>) <span class="comment">// 允许所有方法</span></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-design/" rel="tag">web-design</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-vscodeShortCut和snippet"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/03/18/vscodeShortCut%E5%92%8Csnippet/"
    >vscodeShortCut和snippet</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/03/18/vscodeShortCut%E5%92%8Csnippet/" class="article-date">
  <time datetime="2021-03-18T01:33:48.000Z" itemprop="datePublished">2021-03-18</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/web-Design/">web-Design</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="vscodeShortCut和snippet"><a href="#vscodeShortCut和snippet" class="headerlink" title="vscodeShortCut和snippet"></a>vscodeShortCut和snippet</h1><h2 id="ShortCut快捷键"><a href="#ShortCut快捷键" class="headerlink" title="ShortCut快捷键"></a>ShortCut快捷键</h2><blockquote>
<p>前面的为vscode默认绑定，后面为个人修改绑定</p>
</blockquote>
<blockquote>
<p>开关</p>
</blockquote>
<ul>
<li>打开文件：’Ctrl+O’</li>
<li>关闭窗口：’Ctrl+W’</li>
<li>关闭所有窗口：’Ctrl+K’</li>
<li>关闭右侧所有窗口：’Ctrl+L’</li>
<li>最近打开文件：’Ctrl+E’</li>
<li>打开工作区：’Ctrl+Shift+O’</li>
<li>新建窗口：’Ctrl+Shift+N’</li>
<li>打开左侧栏聚焦文件：’Shift+Alt+R’==&gt;’Ctrl+R’</li>
<li>打开此页面的终端：’Ctrl+Shift+C’</li>
</ul>
<hr>
<blockquote>
<p>处理代码</p>
</blockquote>
<ul>
<li>触发建议：’Ctrl+i’</li>
<li>断点：’F9’</li>
<li>格式化文档：’Shift+Alt+F’==&gt;’Ctrl+Shift+W’</li>
<li>后退：’Alt+左箭头’</li>
<li>前进：’Alt+右箭头’</li>
<li>块注释：’Shift+Alt+A’</li>
<li>折叠：’Ctrl+K Ctrl+L’==&gt;’Ctrl+Shift+Z’</li>
<li>放大/缩小：’ctrl+”=或-“‘</li>
<li>拆分编辑器：’Ctrl+”/“‘</li>
<li>显示/隐藏下方工作台：’Ctrl+J’</li>
</ul>
<hr>
<blockquote>
<p>键盘操作代码</p>
</blockquote>
<ul>
<li><p>向上/下复制行：’Shift+Alt+上箭头/下箭头’</p>
</li>
<li><p>向上/下移动行：’Alt+上箭头/下箭头’</p>
</li>
<li><p>删除整行：’Ctrl+Shift+K’==&gt;’Ctrl+D’</p>
</li>
<li><p>在上面插入行：’Ctrl+Shift+Enter’</p>
</li>
<li><p>在下面插入行：’Ctrl+Enter’</p>
</li>
<li><p>在上/下添加光标：’Ctrl+Alt+上箭头/下箭头’，多行操作</p>
</li>
<li><p>转到括号：’Ctrl+Shift+”\“‘</p>
</li>
</ul>
<blockquote>
<p>剩余便利的快捷键</p>
</blockquote>
<ul>
<li>剪切：’Shift+Delete’</li>
</ul>
<h2 id="Snippet代码片段"><a href="#Snippet代码片段" class="headerlink" title="Snippet代码片段"></a>Snippet代码片段</h2><blockquote>
<p>个人的Snippet，因为觉得别人的不习惯于是都是自己做的</p>
<p>快捷创建Snippet网站：<a target="_blank" rel="noopener" href="https://snippet-generator.app/">https://snippet-generator.app</a></p>
</blockquote>
<blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;jf&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;jf&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;&lt;html&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  &lt;body&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  &lt;/body&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  &lt;script&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;    $&#123;1:content&#125;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  &lt;/script&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;&lt;/html&gt;&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Build for fast js test&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">&quot;---&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;line&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;console.log(&#x27;----------------------&#x27;)&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;---&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">&quot;canvas fast init&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;cf&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;&lt;html&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  &lt;head&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;    &lt;style&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;      body &#123;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;        text-align: center;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;        padding-top: 20px;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;      &#125;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;      canvas &#123;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;        box-shadow: 0 0 10px #333;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;        margin: 0 auto;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;      &#125;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;    &lt;/style&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;    &lt;script&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;      /** @type &#123;HTMLCanvasElement&#125; */&quot;</span>,</span><br><span class="line">			<span class="string">&quot;        function draw() &#123;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;          var canvas = document.getElementById(&#x27;canvas&#x27;)&quot;</span>,</span><br><span class="line">			<span class="string">&quot;          if (canvas.getContext) &#123;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;            var ctx = canvas.getContext(&#x27;2d&#x27;)&quot;</span>,</span><br><span class="line">			<span class="string">&quot;            $&#123;1:content&#125;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;          &#125;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;        &#125;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;    &lt;/script&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  &lt;/head&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  &lt;body onload=\&quot;draw()\&quot;&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;    &lt;canvas id=\&quot;canvas\&quot; width=\&quot;800\&quot; height=\&quot;600\&quot;&gt;&lt;/canvas&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  &lt;/body&gt;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;&lt;/html&gt;&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;canvas fast init&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">&quot;import&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;import&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;import $&#123;1:module&#125; from &#x27;./$&#123;1:module&#125;&#x27;&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;import&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>JavaScript</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;editor.snippetSuggestions&quot;</span>:<span class="string">&quot;top&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;Print to console&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;log&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;console.log($1)&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Log output to console&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">&quot;function&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;fun&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;function $&#123;1:name&#125;() &#123;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;function&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">&quot;newError&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;tne&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;throw new Error($&#123;1:Error&#125;)&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;newError&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">&quot;dw&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;dw&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;document.writeln($&#123;1:content&#125;)&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;dw&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">&quot;lw&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;lw&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;let $&#123;1:name&#125; = function () &#123;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;  $&#123;2:content&#125;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;lw&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">&quot;console.log Vaiable and &#x27;name&#x27;&quot;</span>: &#123;</span><br><span class="line">		<span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;lt&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">			<span class="string">&quot;console.log(&#x27;$&#123;1:variable&#125;&#x27;,$&#123;1:variable&#125;)&quot;</span></span><br><span class="line">		],</span><br><span class="line">		<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;console.log Vaiable and &#x27;name&#x27;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>Vue</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;Print to console&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;log&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;console.log(&#x27;$1&#x27;);&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$2&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Log output to console&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">&quot;Create vue template&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;prefix&quot;</span>: <span class="string">&quot;vue&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;&lt;template&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  &lt;div class=\&quot;\&quot;&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;    content&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  &lt;/div&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&lt;/template&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&lt;script&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;export default &#123;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  name: &#x27;&#x27;,&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  components: &#123;&#125;,&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  props: [],&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  data () &#123;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;    return &#123;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;    &#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  &#125;,&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  computed: &#123;&#125;,&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  watch: &#123;&#125;,&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  created () &#123;&#125;,&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  mounted () &#123;&#125;,&quot;</span>,</span><br><span class="line">                <span class="string">&quot;  methods: &#123;&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&lt;/script&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&lt;style lang=\&quot;scss\&quot; scoped&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&lt;/style&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Create vue template&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-design/" rel="tag">web-design</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-剑指Offer"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/03/05/%E5%89%91%E6%8C%87Offer/"
    >剑指Offer</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/03/05/%E5%89%91%E6%8C%87Offer/" class="article-date">
  <time datetime="2021-03-05T08:46:49.000Z" itemprop="datePublished">2021-03-05</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/web-Design/">web-Design</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="面试的流程"><a href="#面试的流程" class="headerlink" title="面试的流程"></a>面试的流程</h1><h2 id="远程面试"><a href="#远程面试" class="headerlink" title="远程面试"></a>远程面试</h2><blockquote>
<p>面试官会认可应聘者的编程习惯</p>
<ol>
<li>思考清楚再开始编码</li>
<li>良好的代码命名和缩进对齐</li>
<li>能够单元测试</li>
<li>遇到问题解决的调试能力</li>
</ol>
</blockquote>
<h2 id="面试的三个环节"><a href="#面试的三个环节" class="headerlink" title="面试的三个环节"></a>面试的三个环节</h2><h3 id="行为面试"><a href="#行为面试" class="headerlink" title="行为面试"></a>行为面试</h3><blockquote>
<p>面试官参照简历了解应聘者过往的经验</p>
</blockquote>
<h4 id="应聘者的项目经验"><a href="#应聘者的项目经验" class="headerlink" title="应聘者的项目经验"></a>应聘者的项目经验</h4><h5 id="项目经验"><a href="#项目经验" class="headerlink" title="项目经验"></a>项目经验</h5><p>描述项目的STAR模型：</p>
<ol>
<li>首先进行<code>简短的项目背景</code>介绍：比如项目的规模，软件的功能，目标用户等</li>
<li>接下来讲述自己<code>完成的任务</code>：注意区分参与和负责</li>
<li>为完成任务<code>做了哪些工作</code>，<code>怎么做的</code>：详细介绍</li>
<li>自己的<code>贡献</code>：具体些，最好用数字加以说明</li>
</ol>
<p>常问问题：</p>
<ul>
<li>你在该项目中碰到的最大的问题是什么，你是怎么解决的？</li>
<li>从这个项目中你学到了什么？</li>
<li>什么时候会和其他团队成员有什么冲突，你们是怎么解决的？</li>
</ul>
<h5 id="应聘者掌握的技能"><a href="#应聘者掌握的技能" class="headerlink" title="应聘者掌握的技能"></a>应聘者掌握的技能</h5><blockquote>
<p>注意了解、熟悉和精通的区别</p>
<p>了解：对某一个技术只是<code>看过</code>，没有做过实际的项目。不建议在简历中列出只是肤浅了解的技能</p>
<p>熟悉：在<code>实际项目</code>中使用某一项技术有已经较长的时间，通过<code>查阅相关的文档</code>可以独立解决大部分的问题。</p>
</blockquote>
<h5 id="为什么跳槽"><a href="#为什么跳槽" class="headerlink" title="为什么跳槽"></a>为什么跳槽</h5><blockquote>
<p>根据真实想法即可，但是避免以下原因</p>
<ol>
<li>老板太苛责</li>
<li>同事太难相处</li>
<li>加班太频繁</li>
<li>工资太低</li>
</ol>
</blockquote>
<blockquote>
<p>通式：工作做了一段时间没有激情了，换一份更有挑战的工作。具体论述为什么厌倦以前的职位，这个职位为什么吸引自己。</p>
</blockquote>
<h3 id="技术面试"><a href="#技术面试" class="headerlink" title="技术面试"></a>技术面试</h3><blockquote>
<p>应聘者需要具备的素质：</p>
<ul>
<li>基础知识扎实全面，包括编程语言、数据结构、算法等</li>
<li>编写出高质量的代码：测试先行，再写代码</li>
<li>能思路清晰的分析，解决复杂问题</li>
<li>能从时间、空间复杂度两方面优化算法效率</li>
<li>具备优秀的沟通效率、学习能力、发散思维等</li>
</ul>
</blockquote>
<h3 id="应聘者提问"><a href="#应聘者提问" class="headerlink" title="应聘者提问"></a>应聘者提问</h3><blockquote>
<p>应聘者提问自己最感兴趣的问题</p>
</blockquote>
<blockquote>
<p>不适合提问的内容：</p>
<ul>
<li>不要问和自己职位无关的内容</li>
<li>不要问薪水</li>
<li>不要立即打听面试结果</li>
</ul>
</blockquote>
<blockquote>
<p>适合提问的是<code>与自己的职位或者项目相关的问题.</code></p>
</blockquote>
<h1 id="面试需要的基础知识"><a href="#面试需要的基础知识" class="headerlink" title="面试需要的基础知识"></a>面试需要的基础知识</h1><blockquote>
<p>如常用的设计模式、数据结构等</p>
</blockquote>
<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><blockquote>
<p>大多数面试是围绕着<code>数组</code>、<code>字符串</code>、<code>链表</code>、<code>树</code>、<code>栈</code>及<code>队列</code>这几种常见的数据结构展开的</p>
<p>在解决问题的时候一定要注意鲁棒性(即健壮性)，不要被边界值给绊倒</p>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-design/" rel="tag">web-design</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-敏捷软件开发"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/03/03/%E6%95%8F%E6%8D%B7%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/"
    >敏捷软件开发</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/03/03/%E6%95%8F%E6%8D%B7%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/" class="article-date">
  <time datetime="2021-03-03T01:11:45.000Z" itemprop="datePublished">2021-03-03</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/web-Design/">web-Design</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="敏捷开发"><a href="#敏捷开发" class="headerlink" title="敏捷开发"></a>敏捷开发</h1><h2 id="敏捷实践"><a href="#敏捷实践" class="headerlink" title="敏捷实践"></a>敏捷实践</h2><h3 id="敏捷联盟"><a href="#敏捷联盟" class="headerlink" title="敏捷联盟"></a>敏捷联盟</h3><blockquote>
<p>敏捷联盟宣言：</p>
<p><code>个体和交互</code>胜过过程和工具</p>
<p><code>可以工作的软件</code>胜过面面俱到的文档</p>
<p><code>客户合作</code>胜过合同谈判</p>
<p><code>响应变化</code>胜过遵循计划</p>
</blockquote>
<h4 id="个体和交互胜过过程和工具"><a href="#个体和交互胜过过程和工具" class="headerlink" title="个体和交互胜过过程和工具"></a>个体和交互胜过过程和工具</h4><blockquote>
<p>首先应该致力于团队的凝聚力，一流的团队里的人员可能能力不是一流的，但是合作能力绝对是一流的</p>
<p>工具不是首要的，先从小工具试起，等到证明需要更大工具的时候再替换，因为更大的工具可能会带来更多的麻烦</p>
</blockquote>
<h4 id="可以工作的软件胜过面面俱到的文档"><a href="#可以工作的软件胜过面面俱到的文档" class="headerlink" title="可以工作的软件胜过面面俱到的文档"></a>可以工作的软件胜过面面俱到的文档</h4><blockquote>
<p>过多的文档比过少的文档更糟糕，这会花费大量时间</p>
<p>在给新成员传授知识时，最好的两份文档是代码和团队：代码没有二义性，而与团队成员交流的过程中，可以增进交互</p>
</blockquote>
<h4 id="客户合作胜过合同谈判"><a href="#客户合作胜过合同谈判" class="headerlink" title="客户合作胜过合同谈判"></a>客户合作胜过合同谈判</h4><blockquote>
<p>成功的项目需要有序、频繁的客户反馈。 不是依赖于合同或者关于工作的陈述</p>
<p>如：项目开发周期内，固定每周几把软件提交给客户，过几天客户会发来一份软件变更列表，开发者把这些变更放在一起排优先级，并安排在接下来的工作里</p>
</blockquote>
<h4 id="响应变化胜过遵循计划"><a href="#响应变化胜过遵循计划" class="headerlink" title="响应变化胜过遵循计划"></a>响应变化胜过遵循计划</h4><blockquote>
<p>计划不能考虑的过远</p>
<p>更好的做法是：为下两周做详细计划，为下三个月做粗略的计划，再以后就做极为粗糙的计划</p>
</blockquote>
<h3 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h3><blockquote>
<p>从上述价值观引出下面12条原则</p>
</blockquote>
<ol>
<li>我们最优先要做的是通过尽早的、持续的交付有价值的软件来使客户满意</li>
<li>即使到了开发后期，也欢迎改变需求。敏捷过程利用变化来为客户创造竞争优势</li>
<li>经常性地交付可以工作的软件，交付的间隔可以从几周到几个月，交付的时间间隔越短越好</li>
<li>在整个项目开发期间，业务人员和开发人员必须天天都在一起工作</li>
<li>围绕被激励起来的个人来构建项目，给他们提供所需要的环境和支持，并且信任他们能够完成工作</li>
<li>在团队内部，最具有效果并且富有效率的传递信息的方法就是面对面交谈</li>
<li>工作的软件是首要的进度度量标准</li>
<li>敏捷过程提纲可持续的开发速度。责任人、开发者和用户应该能够保持一个长期的、恒定的开发速度</li>
<li>不断地关注优秀的技能和好的设计会增强敏捷能力</li>
<li>简单–使未完成的工作最大化的艺术–是根本的</li>
<li>最好的架构、需求和设计出自于自组织的团队</li>
<li>每隔一段时间，团队会在如何才能更有效地工作方面进行反省，然后相应地对自己的行为进行调整</li>
</ol>
<h2 id="极限编程概述"><a href="#极限编程概述" class="headerlink" title="极限编程概述"></a>极限编程概述</h2><blockquote>
<p>极限编程(XP)是敏捷方法中最著名的一个，它由一系列简单缺互相依赖的实践组成</p>
</blockquote>
<h3 id="客户作为团队成员"><a href="#客户作为团队成员" class="headerlink" title="客户作为团队成员"></a>客户作为团队成员</h3><blockquote>
<p>客户可能是用户团体委派的代表，也可能是支付开发费用的人。无论是谁，他们都是能够和团队一起工作的团队成员，且距离不能太远，100米内尚佳。如果确实无法和客户在一起工作，就去寻找能够在一起工作、愿意并能代替真正客户的人</p>
</blockquote>
<h3 id="用户素材"><a href="#用户素材" class="headerlink" title="用户素材"></a>用户素材</h3><blockquote>
<p>根据跟客户谈话的内容来增加用户素材，即对需求的细节，这些放在索引卡片上以供想起</p>
</blockquote>
<h3 id="短交付周期"><a href="#短交付周期" class="headerlink" title="短交付周期"></a>短交付周期</h3><blockquote>
<p>XP项目<code>每两周</code>交付一次可以工作的软件</p>
</blockquote>
<h4 id="迭代计划"><a href="#迭代计划" class="headerlink" title="迭代计划"></a>迭代计划</h4><blockquote>
<p>每次迭代通常耗时<code>两周</code>。这次<code>迭代的内容不一定加入到产品中</code>，它由客户根据开发人员确定的预算而选择的一些<code>用户素材</code>组成，只要估算成本不超过预算，客户就可以为本次迭代选择任意数量的用户素材。</p>
<p>一旦迭代开始，<code>客户就同意不再修改</code>当次迭代中用户素材的定义和优先级别，开发人员可以拆解并自定义优先级来实现这些任务</p>
</blockquote>
<h4 id="发布计划"><a href="#发布计划" class="headerlink" title="发布计划"></a>发布计划</h4><blockquote>
<p>XP团队通常会创建一个计划来规划随后大约6次迭代的内容，这就是所谓的发布计划，一次发布通常需要<code>3个月</code>事件，通常<code>此次交付会被加入到产品中</code>。发布计划是由一组客户根据开发人员给出的预算所选择的、排好优先级别的用户素材组成</p>
<p>发布计划不是一成不变的，<code>客户可以随时改变</code>计划的内容</p>
</blockquote>
<h3 id="验收测试"><a href="#验收测试" class="headerlink" title="验收测试"></a>验收测试</h3><blockquote>
<p>同样可以通过客户指定的验收测试形式来获取用户素材，用户素材的验收测试是在就要实现该用户素材之前或实现该用户素材的同时进行编写的，即先写测试用例再开发，遵循TDD</p>
</blockquote>
<h3 id="结对编程"><a href="#结对编程" class="headerlink" title="结对编程"></a>结对编程</h3><blockquote>
<p>所有的产品代码都是由结对的程序员使用同一台电脑完成，一位输入代码，另一位观察输入的代码并寻找其中的错误和可以改进的地方</p>
<p>结对的关系每天至少要改变一次，也就是说每个程序员每天在至少两个不同的结对中工作</p>
</blockquote>
<h3 id="测试驱动的开发方法"><a href="#测试驱动的开发方法" class="headerlink" title="测试驱动的开发方法"></a>测试驱动的开发方法</h3><blockquote>
<p>为了使测试用例通过而编写代码时，这样的代码就被定义为可测试的代码。这样做会使开发人员去解耦各个模块。</p>
</blockquote>
<h3 id="持续集成"><a href="#持续集成" class="headerlink" title="持续集成"></a>持续集成</h3><blockquote>
<p>程序员会每天多次拆出拆入他们的代码进行集成</p>
<p>故而XP团队每天会进行多次系统构建，他们会重新创建整个系统</p>
</blockquote>
<h3 id="可持续的开发速度"><a href="#可持续的开发速度" class="headerlink" title="可持续的开发速度"></a>可持续的开发速度</h3><blockquote>
<p>团队必须要有意识地保持稳定、适中的速度</p>
<p>XP的规则是不允许团队加班工作，在版本发布前的一个星期是这个规则的惟一例外</p>
</blockquote>
<h3 id="开放的工作空间"><a href="#开放的工作空间" class="headerlink" title="开放的工作空间"></a>开放的工作空间</h3><blockquote>
<p>团队在一个开放的房间中一起工作，房间中有一些桌子，每张桌子上摆放了两到三台工作站，每台工作站前有给结对编程人员预备的两把椅子，墙壁上挂满了状态图标、任务明细表、UML图等等</p>
</blockquote>
<h3 id="简单的设计"><a href="#简单的设计" class="headerlink" title="简单的设计"></a>简单的设计</h3><blockquote>
<p>XP团队仅仅关注于计划在本次迭代中要完成的用户素材</p>
<p>这意味着XP团队的工作可能不会从基础结构开始，可能不会先去选择使用数据库或者中间件</p>
<p>只有当出现一个用户素材迫切需要基础结构时，才会引入该结构基础</p>
</blockquote>
<h4 id="考虑能够工作的最简单的事情"><a href="#考虑能够工作的最简单的事情" class="headerlink" title="考虑能够工作的最简单的事情"></a>考虑能够工作的最简单的事情</h4><blockquote>
<p>XP团队总是尽可能寻找能实现当前用户素材的最简单的设计</p>
<p>能够用平面文件，就不用数据库…</p>
</blockquote>
<h4 id="你将不需要它"><a href="#你将不需要它" class="headerlink" title="你将不需要它"></a>你将不需要它</h4><blockquote>
<p>如果在确实需要基础结构前拒绝引入它，会发生什么呢？XP团队会对此进行认真的思考</p>
<p>只有在有证据表明现在引入这些基础结构比继续等待更加合算时，团队才会引入这些基础结构</p>
</blockquote>
<h4 id="一次，并且只有一次"><a href="#一次，并且只有一次" class="headerlink" title="一次，并且只有一次"></a>一次，并且只有一次</h4><blockquote>
<p>极限编程者不能容忍重复的代码</p>
</blockquote>
<h3 id="重构"><a href="#重构" class="headerlink" title="重构"></a>重构</h3><blockquote>
<p>XP团队通过经常性的代码重构来扭转代码结构的退化</p>
<p>重构是持续进行的，不是在项目结束时、发布版本时、迭代结束时、甚至每天快下班时</p>
<p>重构是每隔一个或半个小时就要做的事情，以保证代码整洁并富有表现力</p>
</blockquote>
<h3 id="隐喻"><a href="#隐喻" class="headerlink" title="隐喻"></a>隐喻</h3><blockquote>
<p>用隐喻来比喻整个系统</p>
</blockquote>
<h1 id="敏捷设计"><a href="#敏捷设计" class="headerlink" title="敏捷设计"></a>敏捷设计</h1><blockquote>
<p>面向对象设计原则：</p>
<ol>
<li>单一职责原则(SRP)</li>
<li>开放–封闭原则(OCP)</li>
<li>Liskov替换原则(LSP)</li>
<li>依赖倒置原则(DIP)</li>
<li>接口隔离原则(ISP)</li>
</ol>
</blockquote>
<blockquote>
<p>注：以下实现只是思想简单实现，深入请看各具体设计模式</p>
</blockquote>
<h2 id="单一职责原则-SRP"><a href="#单一职责原则-SRP" class="headerlink" title="单一职责原则(SRP)"></a>单一职责原则(SRP)</h2><blockquote>
<p>就一个类来说，应该<code>仅有一个</code>引起它变化的原因</p>
</blockquote>
<h3 id="什么是职责"><a href="#什么是职责" class="headerlink" title="什么是职责"></a>什么是职责</h3><blockquote>
<p>在SRP中，我们把职责定义为<code>变化的原因</code>，如果你能够想到多于一个动机去改变一个类，那么它的职责就多于一个</p>
<p>只有有征兆会发生这种变化时才有意义，否则去应用SRP或者其他什么原则都不明智</p>
</blockquote>
<p>何时分离？</p>
<ul>
<li>当应用程序的变化导致两个职责不同时变化,这时需要分离</li>
<li>当应用程序的变化总是导致这两个职责同时变化，就不必分离它。此时分离它还会使复杂性增加</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 违反SRP</span></span><br><span class="line"><span class="keyword">let</span> draw = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;计算面积&#x27;</span>) <span class="comment">// 职责一</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;绘制图形&#x27;</span>) <span class="comment">// 职责二</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遵守SRP之拆分职责</span></span><br><span class="line"><span class="keyword">let</span> getArea = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 职责一</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;计算面积&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> drawSomething = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 职责二</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;绘制图形&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> drawArea = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 统一调用</span></span><br><span class="line">  getArea()</span><br><span class="line">  drawSomething()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遵守SRP之不用拆分</span></span><br><span class="line"><span class="keyword">let</span> CT = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 转发器的两个职责总是同时发生变化</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;收到信号&#x27;</span>) <span class="comment">// 职责一</span></span><br><span class="line">  <span class="comment">// 真实的转发器还有收到信号放大变频的过程，可以通过开放封闭原则的钩子来进行隔离变化</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;转发信号&#x27;</span>) <span class="comment">// 职责二</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="开放–封闭原则-OCP"><a href="#开放–封闭原则-OCP" class="headerlink" title="开放–封闭原则(OCP)"></a>开放–封闭原则(OCP)</h2><blockquote>
<p>软件实体(类、模块、函数等)应该是可以扩展的，但是不可修改</p>
<p>因为一旦修改会造成一系列连锁反应</p>
</blockquote>
<h3 id="关键是抽象"><a href="#关键是抽象" class="headerlink" title="关键是抽象"></a>关键是抽象</h3><blockquote>
<p>在C++、Java等OOPL(面向对象编程语言)中，可以创建出抽象基类作为这个抽象体。</p>
<p>通过这个抽象体的派生来扩展这个模块而不用修改这个抽象体</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 抽象</span></span><br><span class="line"><span class="keyword">let</span> Shape = &#123;</span><br><span class="line">  draw: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;draw&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 细节</span></span><br><span class="line"><span class="keyword">let</span> Square = Shape <span class="comment">// 细节依赖抽象</span></span><br><span class="line"><span class="keyword">let</span> Circle = Shape</span><br><span class="line"><span class="comment">// 他们二者都拥有了Shape方法</span></span><br><span class="line"><span class="built_in">console</span>.log(Square)</span><br><span class="line"><span class="built_in">console</span>.log(Circle)</span><br></pre></td></tr></table></figure>



<h3 id="预测变化和“贴切的”结构"><a href="#预测变化和“贴切的”结构" class="headerlink" title="预测变化和“贴切的”结构"></a>预测变化和“贴切的”结构</h3><blockquote>
<p>因为无论一个模块多”封闭”，都会有无法封闭的变化，比如上面的代码，当我们要决定Shape里面draw具体细节，这时就无法封闭了，除非我们写死。所以我们需要找出最有可能<code>发生变化</code>的地方，然后再构造<code>抽象</code>来<code>隔离变化</code>。</p>
<p>这也引出了OCP出现的场景，隔离变化的地方，将不变的地方封闭。</p>
</blockquote>
<h3 id="放置钩子-hook"><a href="#放置钩子-hook" class="headerlink" title="放置钩子(hook)"></a>放置钩子(hook)</h3><blockquote>
<p>在以前，开发者往往会自主选择在可能发生变化的地方放置钩子。</p>
<p>然而事实证明，这只会让我们承受不必要的复杂性。</p>
<p>所以应该等到<code>确实需要那些抽象的时候再放钩子进去</code></p>
</blockquote>
<p>在js里面可以通过throw Error的方式来强制重写钩子内容</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Shape = &#123;</span><br><span class="line">  draw: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// console.log(&#x27;顺时针绘制&#x27;) // 写死情况</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;请重写方法&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> Square = Shape</span><br><span class="line"><span class="keyword">let</span> Circle = Shape</span><br><span class="line"><span class="comment">// Square.draw() // 报错</span></span><br><span class="line">Square.draw = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 重写方法</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;逆时针绘制&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">Square.draw()</span><br></pre></td></tr></table></figure>



<h2 id="Liskov替换原则-LSP"><a href="#Liskov替换原则-LSP" class="headerlink" title="Liskov替换原则(LSP)"></a>Liskov替换原则(LSP)</h2><blockquote>
<p>简单来说，LSP原则就是父类必须是子类共有的部分，不能超出</p>
</blockquote>
<p>书中的例子用js重写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 违反LSP</span></span><br><span class="line"><span class="keyword">let</span> Rectangle = &#123; <span class="comment">// 矩形</span></span><br><span class="line">  height: <span class="literal">undefined</span>,</span><br><span class="line">  width: <span class="literal">undefined</span>,</span><br><span class="line">  getWidth: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  getHeight: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> Square = Rectangle <span class="comment">// 正方形</span></span><br><span class="line">Square.getHeight = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 需要重载父类</span></span><br><span class="line">  <span class="keyword">return</span> width</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遵守LSP</span></span><br><span class="line"><span class="keyword">let</span> Quadrangle = &#123; <span class="comment">// 四边形，只取子类共有的部分</span></span><br><span class="line">  width: <span class="literal">undefined</span>,</span><br><span class="line">  getWidth:<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> Rectangle = Quadrangle <span class="comment">// 通过添加方法而不是重载</span></span><br><span class="line">Rectangle.getHeight = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> Square = Quadrangle <span class="comment">// 正方形</span></span><br></pre></td></tr></table></figure>





<h2 id="依赖倒置原则-DIP"><a href="#依赖倒置原则-DIP" class="headerlink" title="依赖倒置原则(DIP)"></a>依赖倒置原则(DIP)</h2><blockquote>
<p>这里倒置的意思是：高层不再依赖底层，抽象不再依赖实现，而是如下</p>
</blockquote>
<blockquote>
<ul>
<li>高层(业务逻辑)不应该依赖于底层(原子逻辑)，两者都应该依赖抽象(接口或抽象类)</li>
<li>抽象不应该依赖细节(实现类)，细节应该依赖抽象</li>
</ul>
</blockquote>
<p><img src="/2021/03/03/%E6%95%8F%E6%8D%B7%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/1.jpg"></p>
<h3 id="层次化"><a href="#层次化" class="headerlink" title="层次化"></a>层次化</h3><blockquote>
<p>高层通过依赖抽象服务接口来获取服务，底层通过依赖高层声明的抽象接口来实现服务</p>
</blockquote>
<p><img src="/2021/03/03/%E6%95%8F%E6%8D%B7%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/2.jpg"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 违反DIP</span></span><br><span class="line"><span class="keyword">let</span> peopleBreakDIP = &#123;</span><br><span class="line">  eatShit: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 高层依赖底层，吃的必须是shit</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;当回老八&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.writeln(peopleBreakDIP.eatShit())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遵守DIP</span></span><br><span class="line"><span class="keyword">let</span> peopleObeyDIP = &#123;</span><br><span class="line">  eatSomething: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 高层依赖抽象，吃啥都可以</span></span><br><span class="line">    <span class="comment">// 吃啥好</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">peopleObeyDIP.eatSomething = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 底层实现高层抽象,还是同一个撤硕</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;同一个撤硕&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.writeln(peopleObeyDIP.eatSomething())</span><br></pre></td></tr></table></figure>



<h2 id="接口隔离原则-ISP"><a href="#接口隔离原则-ISP" class="headerlink" title="接口隔离原则(ISP)"></a>接口隔离原则(ISP)</h2><blockquote>
<p>简单来说：就是当有的类继承接口后发现部分方法不需要，这时就需要给接口瘦身，去掉部分不需要的方法</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 违反ISP</span></span><br><span class="line"><span class="keyword">let</span> eatBreakISP = &#123;</span><br><span class="line">  <span class="comment">// 这里的eatShit/eatRice类比两个接口</span></span><br><span class="line">  eatShit: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;当回老八&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  eatRice: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;来点米饭&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> people = &#123;&#125; <span class="comment">// 这里people并不想继承所有的方法</span></span><br><span class="line">people.eat = eat</span><br><span class="line"><span class="keyword">let</span> oldEight = &#123;&#125;</span><br><span class="line">oldEight.eat = eat</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遵守ISP</span></span><br><span class="line"><span class="keyword">let</span> eatObeyISP = &#123;</span><br><span class="line">  eatRice: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;来点米饭&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> people = &#123;&#125; <span class="comment">// people继承他和OldEight同时可以吃的</span></span><br><span class="line">people.eat = eat</span><br><span class="line"><span class="keyword">let</span> oldEight = &#123;&#125;</span><br><span class="line">oldEight.eat = eat</span><br><span class="line">oldEight.eat.eatShit = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// oldEight自创美食</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;同一个撤硕&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="薪水支付案例研究"><a href="#薪水支付案例研究" class="headerlink" title="薪水支付案例研究"></a>薪水支付案例研究</h1><h2 id="COMMAND-命令-模式和ACTIVE-OBJECT-主动对象-模式"><a href="#COMMAND-命令-模式和ACTIVE-OBJECT-主动对象-模式" class="headerlink" title="COMMAND(命令)模式和ACTIVE OBJECT(主动对象)模式"></a>COMMAND(命令)模式和ACTIVE OBJECT(主动对象)模式</h2><blockquote>
<p>Command模式将高层与底层接口，他们共同依赖向Command接口</p>
<p>高层仅调用Command的do()接口即可，底层仅实现Command的do()即可</p>
<p>Active Object配合Command使用多线程</p>
</blockquote>
<p><img src="/2021/03/03/%E6%95%8F%E6%8D%B7%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/3.jpg"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Command = &#123; <span class="comment">// 命令</span></span><br><span class="line">  commandList: [], <span class="comment">// 抽象指令列表</span></span><br><span class="line">  insert: <span class="function"><span class="keyword">function</span> (<span class="params">fun</span>) </span>&#123; <span class="comment">// 添加指令</span></span><br><span class="line">    <span class="built_in">this</span>.commandList.push(fun)</span><br><span class="line">  &#125;,</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 运行所有指令</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.commandList.length; i++) &#123;</span><br><span class="line">      <span class="built_in">this</span>.commandList[i].execute()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> commandDraw = &#123; <span class="comment">// 原子指令</span></span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;draw&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> commandArea = &#123; <span class="comment">// 原子指令</span></span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;area&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Command.insert(commandDraw)</span><br><span class="line">Command.insert(commandArea)</span><br><span class="line">Command.execute()</span><br></pre></td></tr></table></figure>



<h2 id="TEMPLATE-METHOD-模板方法-模式与STRATEGY-策略-模式：继承与委托"><a href="#TEMPLATE-METHOD-模板方法-模式与STRATEGY-策略-模式：继承与委托" class="headerlink" title="TEMPLATE METHOD(模板方法)模式与STRATEGY(策略)模式：继承与委托"></a>TEMPLATE METHOD(模板方法)模式与STRATEGY(策略)模式：继承与委托</h2><blockquote>
<p>继承容易被过度使用且代价高昂，故推荐优先使用对象组合</p>
<p>我们常常使用组合/委托来替代它</p>
<p>Template Method使用<code>继承</code>解决问题，而Strategy使用<code>委托</code></p>
</blockquote>
<h3 id="Template-Method-模板方法模式"><a href="#Template-Method-模板方法模式" class="headerlink" title="Template Method(模板方法模式)"></a>Template Method(模板方法模式)</h3><blockquote>
<p>这里沿用了DIP里面的代码</p>
<p>可以看到这里放置了隔离变化的钩子(hook)</p>
<p>Template Method通过对父类方法的<code>重写</code>来隔离变化</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Shape = &#123;</span><br><span class="line">  draw: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// console.log(&#x27;顺时针绘制&#x27;) // 写死情况</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;请重写方法&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> Square = Shape</span><br><span class="line"><span class="keyword">let</span> Circle = Shape</span><br><span class="line"><span class="comment">// Square.draw() // 报错</span></span><br><span class="line">Square.draw = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 重写方法</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;逆时针绘制&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">Square.draw()</span><br></pre></td></tr></table></figure>



<h3 id="Strategy-策略模式"><a href="#Strategy-策略模式" class="headerlink" title="Strategy(策略模式)"></a>Strategy(策略模式)</h3><blockquote>
<p>策略模式<code>提前写好</code>对应策略，通过<code>委托</code>例如Opera<code>对象</code>来<code>获取对应操作</code></p>
<p>tip:在实际开发中可以通过策略在同一个策略函数中选择是增(add)还是改(update)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Opera = &#123; <span class="comment">// 委托对象，操作</span></span><br><span class="line">  add: <span class="function"><span class="keyword">function</span> (<span class="params">n1,n2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n1+n2</span><br><span class="line">  &#125;,</span><br><span class="line">  sub: <span class="function"><span class="keyword">function</span> (<span class="params">n1,n2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n1-n2</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.writeln(Opera.add(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line"><span class="built_in">document</span>.writeln(Opera.sub(<span class="number">1</span>,<span class="number">2</span>))</span><br></pre></td></tr></table></figure>



<h2 id="FACADE-外观-模式和MEDIATOR-中介者-模式"><a href="#FACADE-外观-模式和MEDIATOR-中介者-模式" class="headerlink" title="FACADE(外观)模式和MEDIATOR(中介者)模式"></a>FACADE(外观)模式和MEDIATOR(中介者)模式</h2><blockquote>
<p>这两个模式都将某种策略施加到另外一组对象上</p>
<p>FACADE模式从上面施加，MEDIATOR则从下面施加</p>
<p>FACADE模式是明显且受限的，MEDIATOR是不明显且不受限的</p>
</blockquote>
<h3 id="FACADE模式"><a href="#FACADE模式" class="headerlink" title="FACADE模式"></a>FACADE模式</h3><blockquote>
<p>简单来说就是提供一个统一接口对外，就像服务员一样。</p>
<p>在js里面就一个接口对象</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 照着java代码实现，对js来说脱裤子放屁</span></span><br><span class="line"><span class="keyword">let</span> Shape = &#123;</span><br><span class="line">  draw: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> Rectangle = &#123;&#125;</span><br><span class="line">Rectangle.draw = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;画矩形&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> Square = &#123;&#125;</span><br><span class="line">Square.draw = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;画正方形&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> ShapeMaker = &#123; </span><br><span class="line">  drawRectangle: Rectangle.draw,</span><br><span class="line">  drawSquare: Square.draw</span><br><span class="line">&#125;</span><br><span class="line">ShapeMaker.drawRectangle()</span><br><span class="line">ShapeMaker.drawSquare()</span><br><span class="line"></span><br><span class="line"><span class="comment">// js实现</span></span><br><span class="line"><span class="keyword">let</span> ShapeFacade = &#123;</span><br><span class="line">  drawRectangle: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;画矩形&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  drawSquare: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;画正方形&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">ShapeFacade.drawRectangle()</span><br><span class="line">ShapeFacade.drawSquare()</span><br></pre></td></tr></table></figure>



<h3 id="MEDIATOR模式"><a href="#MEDIATOR模式" class="headerlink" title="MEDIATOR模式"></a>MEDIATOR模式</h3><blockquote>
<p>中介者同样也施加策略，不过外观模式是以明显且受限的方式，而中介者则是以隐藏且不受限的方式</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ChatRoom = &#123; <span class="comment">// 中介者</span></span><br><span class="line">  showMessage: <span class="function"><span class="keyword">function</span> (<span class="params">message</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.writeln(message)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> User = &#123;</span><br><span class="line">  name: <span class="literal">undefined</span>,</span><br><span class="line">  sendMessage: <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    ChatRoom.showMessage(msg+<span class="built_in">this</span>.name) <span class="comment">// 调用中介者的方法,客户端看不到这个方法</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="SINGLETON-单例-模式和MONOSTATE-单态-模式"><a href="#SINGLETON-单例-模式和MONOSTATE-单态-模式" class="headerlink" title="SINGLETON(单例)模式和MONOSTATE(单态)模式"></a>SINGLETON(单例)模式和MONOSTATE(单态)模式</h2><h3 id="SINGLETON"><a href="#SINGLETON" class="headerlink" title="SINGLETON"></a>SINGLETON</h3><blockquote>
<p>单例模式，简单来说就是全局只有一个，可以理解为全局变量</p>
<p>单例模式的好处之一就是可以延迟求值</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// js中声明全局变量就是单例的</span></span><br><span class="line"><span class="keyword">var</span> singleTon = <span class="string">&#x27;single&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="MONOSTATE"><a href="#MONOSTATE" class="headerlink" title="MONOSTATE"></a>MONOSTATE</h3><blockquote>
<p>看状态模式即可</p>
</blockquote>
<h1 id="打包薪水支付系统"><a href="#打包薪水支付系统" class="headerlink" title="打包薪水支付系统"></a>打包薪水支付系统</h1><h2 id="粒度：包的内聚性原则"><a href="#粒度：包的内聚性原则" class="headerlink" title="粒度：包的内聚性原则"></a>粒度：包的内聚性原则</h2><h3 id="共同重用原则"><a href="#共同重用原则" class="headerlink" title="共同重用原则"></a>共同重用原则</h3><blockquote>
<p>一个包中的所有类应该是共同重用的。</p>
<p>判断是否应该把类放在同一个包中：如果重用了包中的一个类，那么就要重用包中所有的类</p>
</blockquote>
<h3 id="共同封闭原则"><a href="#共同封闭原则" class="headerlink" title="共同封闭原则"></a>共同封闭原则</h3><blockquote>
<p>包中的所有类对同一类的变化应该是共同封闭的</p>
</blockquote>
<h2 id="稳定性：包的耦合性原则"><a href="#稳定性：包的耦合性原则" class="headerlink" title="稳定性：包的耦合性原则"></a>稳定性：包的耦合性原则</h2><blockquote>
<p>在包的依赖图中不允许存在环</p>
</blockquote>
<blockquote>
<p>经常会出现修改依赖的情况，所以有以下解决方式</p>
</blockquote>
<h3 id="每周构建"><a href="#每周构建" class="headerlink" title="每周构建"></a>每周构建</h3><blockquote>
<p>加快构建频率</p>
</blockquote>
<h3 id="消除依赖环"><a href="#消除依赖环" class="headerlink" title="消除依赖环"></a>消除依赖环</h3><blockquote>
<p>给依赖定版本</p>
</blockquote>
<h3 id="解除依赖环"><a href="#解除依赖环" class="headerlink" title="解除依赖环"></a>解除依赖环</h3><blockquote>
<p>使用依赖倒置原则</p>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-design/" rel="tag">web-design</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-代码整洁之道"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/03/02/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/"
    >代码整洁之道</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/03/02/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/" class="article-date">
  <time datetime="2021-03-02T00:36:15.000Z" itemprop="datePublished">2021-03-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/web-Design/">web-Design</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="代码整洁之道"><a href="#代码整洁之道" class="headerlink" title="代码整洁之道"></a>代码整洁之道</h1><blockquote>
<p>代码质量与其整洁程序成正比</p>
<p>糟糕的代码想做太多事，意图混乱、目的含混。整洁的代码力求集中，每个函数、类、模块贯注于一事。</p>
</blockquote>
<h2 id="有意义的命名"><a href="#有意义的命名" class="headerlink" title="有意义的命名"></a>有意义的命名</h2><blockquote>
<p>为了提高易读性，有意义的命名是必须的</p>
</blockquote>
<h3 id="名副其实"><a href="#名副其实" class="headerlink" title="名副其实"></a>名副其实</h3><blockquote>
<p>是否是一个好的命名标准：<strong>如果名称需要注释来补充，那就不算名副其实</strong>：</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 糟糕的命名</span></span><br><span class="line"><span class="keyword">let</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params">array,num</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; array.length ;)&#123;</span><br><span class="line">    <span class="keyword">if</span> (array[i] === num) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.writeln(foo(array,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 好的例子</span></span><br><span class="line"><span class="keyword">let</span> isNumberExist = <span class="function"><span class="keyword">function</span> (<span class="params">numArray,checkNum</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> flag = <span class="number">0</span> ; flag &lt; numArray.length ;)&#123;</span><br><span class="line">    <span class="keyword">if</span> (numArray[flag++] === checkNum) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.writeln(isNumberExist(array,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更好的例子,将是否等于的判断条件用函数表示出来，更易读</span></span><br><span class="line"><span class="keyword">let</span> isEqual = <span class="function"><span class="keyword">function</span> (<span class="params">checkNumFirst, checkNumSecond</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (checkNumFirst === checkNumSecond) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> isNumberExist = <span class="function"><span class="keyword">function</span> (<span class="params">numArray,checkNum</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> flag = <span class="number">0</span> ; flag &lt; numArray.length ;)&#123;</span><br><span class="line">    <span class="keyword">if</span> (isEqual(numArray[flag++],checkNum)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.writeln(isNumberExist(array,<span class="number">1</span>))</span><br></pre></td></tr></table></figure>



<h3 id="避免误导"><a href="#避免误导" class="headerlink" title="避免误导"></a>避免误导</h3><ol>
<li>别用类似accountList来指代一组账号：除非它真的是List类型，否则使用accountGroup，甚至是accounts更好些。即命名尾巴应该对应类型，否则不应该使用，正确使用let accountArray = []</li>
<li>提防使用不同之处较小的名称：如XYZControllerEffect和XYZContentEffect</li>
<li>提防小写l和大写O：因为它们看起来很像1和0</li>
</ol>
<h3 id="做有意义的区分"><a href="#做有意义的区分" class="headerlink" title="做有意义的区分"></a>做有意义的区分</h3><p>数字系列</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> copyChars = <span class="function"><span class="keyword">function</span> (<span class="params">a1,a2</span>) </span>&#123; <span class="comment">// 糟糕的例子</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; a1.length ; i++) &#123;</span><br><span class="line">    a2[i] = a1[i]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> copyChars = <span class="function"><span class="keyword">function</span> (<span class="params">source,destination</span>) </span>&#123; <span class="comment">// 好的例子</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; source.length ; i++) &#123;</span><br><span class="line">    destination[i] = source[i]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>废话</p>
<blockquote>
<p>假如有productInfo、productData、theProduct…你能区分出它们的区别吗？</p>
<p>如果不能，那就不是好的命名方式</p>
</blockquote>
<h3 id="使用读的出来的名称"><a href="#使用读的出来的名称" class="headerlink" title="使用读的出来的名称"></a>使用读的出来的名称</h3><blockquote>
<p>即避免自创单词缩写，如下</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 糟糕的例子</span></span><br><span class="line"><span class="keyword">let</span> genymdhms</span><br><span class="line"><span class="keyword">let</span> modymdhms</span><br><span class="line"></span><br><span class="line"><span class="comment">// 好的例子</span></span><br><span class="line"><span class="keyword">let</span> generationTimestamp</span><br><span class="line"><span class="keyword">let</span> modificationTimestamp</span><br></pre></td></tr></table></figure>



<h3 id="使用可搜索的名称"><a href="#使用可搜索的名称" class="headerlink" title="使用可搜索的名称"></a>使用可搜索的名称</h3><blockquote>
<p>单字母名称仅用于短方法中的本地变量，名称长短应与其作用域大小相对应，若变量或常量可能在代码中多处使用，应赋予其便于搜索的名称</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 短方法:单字母变量</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; <span class="number">34</span> ; i++) &#123;</span><br><span class="line">    s += t[i]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 常用</span></span><br><span class="line"><span class="keyword">let</span> realDaysPerIdealDay = <span class="number">4</span></span><br><span class="line"><span class="keyword">let</span> WORK_DAYS_PER_WEEK = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; WORK_DAYS_PER_WEEK ; i++)&#123;</span><br><span class="line">    s += t[i]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="避免思维映射"><a href="#避免思维映射" class="headerlink" title="避免思维映射"></a>避免思维映射</h3><blockquote>
<p>避免让读者在脑中把你的名称译为他们熟知的名称：即命名越简单越好，不要用来炫耀自己的知识，也不要玩脑筋急转弯</p>
</blockquote>
<h3 id="类名-对象名"><a href="#类名-对象名" class="headerlink" title="类名/对象名"></a>类名/对象名</h3><blockquote>
<p>类名/对象名应该是名词/名词短语而不是动词</p>
</blockquote>
<h3 id="方法名"><a href="#方法名" class="headerlink" title="方法名"></a>方法名</h3><blockquote>
<p>方法名应当是动词或动词短语</p>
</blockquote>
<h3 id="每个概念对应一个词"><a href="#每个概念对应一个词" class="headerlink" title="每个概念对应一个词"></a>每个概念对应一个词</h3><blockquote>
<p>因为你难以区分fetch/retrieve/get等，以及controller/manager/driver，所以请用一个单词例如Controller来映射所有的控制类</p>
</blockquote>
<h3 id="别用双关语"><a href="#别用双关语" class="headerlink" title="别用双关语"></a>别用双关语</h3><blockquote>
<p>即应该用单词原本的意思而不是为了保持一致而保持一致:如add用于增加或连接两个现有值来获得新值，但是把单个参数放到一个collection中，则适合用insert或append</p>
</blockquote>
<h3 id="使用解决方案领域名称"><a href="#使用解决方案领域名称" class="headerlink" title="使用解决方案领域名称"></a>使用解决方案领域名称</h3><blockquote>
<p>因为只有程序员才会读程序员的代码，所以在使用计算机的术语方面可以无所顾忌</p>
</blockquote>
<h3 id="使用源自所涉问题领域的名称"><a href="#使用源自所涉问题领域的名称" class="headerlink" title="使用源自所涉问题领域的名称"></a>使用源自所涉问题领域的名称</h3><blockquote>
<p>如果不能用程序员熟悉的术语来命名，则用所涉及问题领域的名称</p>
</blockquote>
<h3 id="添加有意义的语境"><a href="#添加有意义的语境" class="headerlink" title="添加有意义的语境"></a>添加有意义的语境</h3><blockquote>
<p>即给一串变量添加前缀，让他们相互说明用来做什么</p>
<p>如addrState，addrFirstName…</p>
</blockquote>
<h3 id="不要添加没用的语境"><a href="#不要添加没用的语境" class="headerlink" title="不要添加没用的语境"></a>不要添加没用的语境</h3><blockquote>
<p>不要在每个类中都添加一样的前缀，因为那样IDE会自动补全一大堆</p>
<p>短名称足够清楚就没必要添加长名称</p>
</blockquote>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="短小"><a href="#短小" class="headerlink" title="短小"></a>短小</h3><blockquote>
<p>函数的第一个规则就是要短小，第二个规则还是要短小</p>
<p>函数20行封顶最佳</p>
</blockquote>
<h4 id="代码块和缩进"><a href="#代码块和缩进" class="headerlink" title="代码块和缩进"></a>代码块和缩进</h4><blockquote>
<p>if/else/while语句，其中的代码块应该只有一行，而那一行应该是一个函数调用语句</p>
<p>这样不仅简单明了，也可以用函数名来解释做了什么</p>
</blockquote>
<h3 id="只做一件事"><a href="#只做一件事" class="headerlink" title="只做一件事"></a>只做一件事</h3><blockquote>
<p>要判断函数是否不止做了一件事，就是看是否能再拆出一个函数，这个函数不仅只是单纯地重新诠释其实现</p>
</blockquote>
<h3 id="每个函数一个抽象层级"><a href="#每个函数一个抽象层级" class="headerlink" title="每个函数一个抽象层级"></a>每个函数一个抽象层级</h3><blockquote>
<p>要确保函数只做一件事，函数中的语句都要在同一抽象层级上</p>
<p>自顶向下读代码：向下规则</p>
<p>每个函数后面跟着位于下一抽象层级的函数</p>
</blockquote>
<h3 id="switch语句"><a href="#switch语句" class="headerlink" title="switch语句"></a>switch语句</h3><blockquote>
<p>为了不破坏诸多低耦合高内聚规则：switch仅用于创建多态对象且隐藏在某个继承关系中，在系统其他部分看不到</p>
</blockquote>
<h3 id="使用描述性名称"><a href="#使用描述性名称" class="headerlink" title="使用描述性名称"></a>使用描述性名称</h3><blockquote>
<p>长而具有描述性的名称比短而令人费解的名称好</p>
<p>长而具有描述性的名称比长注释好</p>
</blockquote>
<h3 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h3><blockquote>
<p>最理想的参数数量是0，其次1，再者2，&gt;=3无论如何也不要这么做</p>
</blockquote>
<h4 id="一元函数的普遍形式"><a href="#一元函数的普遍形式" class="headerlink" title="一元函数的普遍形式"></a>一元函数的普遍形式</h4><blockquote>
<p>作者推荐要么真的只传一个，要么传事件</p>
<p>个人觉得在js中传对象就好，简单明了</p>
</blockquote>
<h4 id="标志参数"><a href="#标志参数" class="headerlink" title="标志参数"></a>标志参数</h4><blockquote>
<p>当需要传参如render(true)布尔值时，应该直接将函数一分为二renderForSuite()和renderForSingleTest()</p>
</blockquote>
<h4 id="二元函数"><a href="#二元函数" class="headerlink" title="二元函数"></a>二元函数</h4><blockquote>
<p> 尽量把两个参数拆分开来，变成两个单参数函数</p>
</blockquote>
<h3 id="输出参数"><a href="#输出参数" class="headerlink" title="输出参数"></a>输出参数</h3><blockquote>
<p>有时候会出现并非输入而作为输出的参数，如appendFooter(s)，这个函数用来在s后面添加，并不作为输入使用，让人迷惑</p>
<p>所以推荐这种写法:report.appendFooter()即对象.方法的形式来改变对象状态</p>
</blockquote>
<h3 id="使用异常代替返回错误码"><a href="#使用异常代替返回错误码" class="headerlink" title="使用异常代替返回错误码"></a>使用异常代替返回错误码</h3><h4 id="抽离try-catch代码块"><a href="#抽离try-catch代码块" class="headerlink" title="抽离try/catch代码块"></a>抽离try/catch代码块</h4><blockquote>
<p>try/catch搞乱了代码结构，最好把try和catch抽离出来另外形成函数</p>
</blockquote>
<h4 id="错误处理就是一件事"><a href="#错误处理就是一件事" class="headerlink" title="错误处理就是一件事"></a>错误处理就是一件事</h4><blockquote>
<p>函数只做一件事，错误处理就是一件事，处理错误的函数不该做其他事</p>
<p>catch/finally代码块后面也不该有其他内容</p>
</blockquote>
<h4 id="Error依赖磁铁"><a href="#Error依赖磁铁" class="headerlink" title="Error依赖磁铁"></a>Error依赖磁铁</h4><blockquote>
<p>程序员往往不愿意增加新的错误代码，于是他们就复用旧的错误码而不添加新的</p>
<p>使用异常替代错误码，新异常就可以从异常类派生出来，无需重新编译或部署</p>
</blockquote>
<h3 id="别重复自己"><a href="#别重复自己" class="headerlink" title="别重复自己"></a>别重复自己</h3><h4 id="结构化编程"><a href="#结构化编程" class="headerlink" title="结构化编程"></a>结构化编程</h4><blockquote>
<p>只要保持函数短小，偶尔出现return、break、continue没有坏处，甚至比单入单出更具表达力。</p>
<p>且不要用goto，会惹大麻烦</p>
</blockquote>
<h3 id="如何写出这样的函数"><a href="#如何写出这样的函数" class="headerlink" title="如何写出这样的函数"></a>如何写出这样的函数</h3><blockquote>
<p>没人做得到一开始就浑然天成，先写出冗长的代码</p>
<p>尔后将其拆分、改名、消除重复…</p>
<p>最后遵循以上规则组装函数</p>
</blockquote>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><blockquote>
<p>注释的恰当用法是弥补我们在用代码表达意图时遭遇失败</p>
<p>注释的缺点在于代码会变动，会变得跟原义相去甚远，甚至指向一个错误的方向</p>
</blockquote>
<h3 id="注释不能美化糟糕的代码"><a href="#注释不能美化糟糕的代码" class="headerlink" title="注释不能美化糟糕的代码"></a>注释不能美化糟糕的代码</h3><blockquote>
<p>如果一块代码需要大量注释，说明需要花时间清洁那些糟糕的代码了</p>
</blockquote>
<h3 id="用代码来阐述"><a href="#用代码来阐述" class="headerlink" title="用代码来阐述"></a>用代码来阐述</h3><blockquote>
<p>用好的命名来代替注释</p>
</blockquote>
<h3 id="好注释"><a href="#好注释" class="headerlink" title="好注释"></a>好注释</h3><h4 id="法律信息"><a href="#法律信息" class="headerlink" title="法律信息"></a>法律信息</h4><h4 id="对意图的解释"><a href="#对意图的解释" class="headerlink" title="对意图的解释"></a>对意图的解释</h4><blockquote>
<p>从更高抽象层次述说这个函数的作用</p>
</blockquote>
<h4 id="阐释"><a href="#阐释" class="headerlink" title="阐释"></a>阐释</h4><blockquote>
<p>如果参数或返回值是某个标准库/不能修改的代码，帮助阐释其含义的代码就很有用了</p>
</blockquote>
<h4 id="警示"><a href="#警示" class="headerlink" title="警示"></a>警示</h4><h4 id="TODO注释"><a href="#TODO注释" class="headerlink" title="TODO注释"></a>TODO注释</h4><blockquote>
<p>利用TODO在源代码中放置要做的工作列表</p>
<p>vscode有插件</p>
</blockquote>
<h3 id="坏注释"><a href="#坏注释" class="headerlink" title="坏注释"></a>坏注释</h3><h4 id="多余的注释"><a href="#多余的注释" class="headerlink" title="多余的注释"></a>多余的注释</h4><blockquote>
<p>这样的注释并没有证明代码的意义，也没有给出代码的意图或逻辑的翻译代码</p>
<p>甚至不如代码精确，读它不如读代码</p>
</blockquote>
<h4 id="误导性注释"><a href="#误导性注释" class="headerlink" title="误导性注释"></a>误导性注释</h4><h4 id="循规式注释"><a href="#循规式注释" class="headerlink" title="循规式注释"></a>循规式注释</h4><blockquote>
<p>如每个函数/变量都要有注释</p>
</blockquote>
<h4 id="日志式注释"><a href="#日志式注释" class="headerlink" title="日志式注释"></a>日志式注释</h4><blockquote>
<p>在代码前部添加日期之类的</p>
</blockquote>
<h4 id="废话注释"><a href="#废话注释" class="headerlink" title="废话注释"></a>废话注释</h4><h4 id="能用函数或变量时就别用注释"><a href="#能用函数或变量时就别用注释" class="headerlink" title="能用函数或变量时就别用注释"></a>能用函数或变量时就别用注释</h4><h4 id="位置标记"><a href="#位置标记" class="headerlink" title="位置标记"></a>位置标记</h4><blockquote>
<p>标记栏如:// Actions ////////////////////</p>
<p>这样引起注意</p>
<p>但不要过多使用</p>
</blockquote>
<h4 id="括号后面的注释"><a href="#括号后面的注释" class="headerlink" title="括号后面的注释"></a>括号后面的注释</h4><blockquote>
<p>如在try的括号末尾添加//try来标识try结束，当出现这种行为意味着应该缩减代码了</p>
</blockquote>
<h4 id="注释掉的代码"><a href="#注释掉的代码" class="headerlink" title="注释掉的代码"></a>注释掉的代码</h4><blockquote>
<p>注释掉的代码并有用，只会堆放在那里形成垃圾</p>
<p>在有版本控制的今天，删就完了</p>
</blockquote>
<h4 id="非本地信息"><a href="#非本地信息" class="headerlink" title="非本地信息"></a>非本地信息</h4><blockquote>
<p>注释应该就近原则，别在函数上面注释系统级信息如端口</p>
</blockquote>
<h4 id="信息过多"><a href="#信息过多" class="headerlink" title="信息过多"></a>信息过多</h4><h4 id="不明显的联系"><a href="#不明显的联系" class="headerlink" title="不明显的联系"></a>不明显的联系</h4><h4 id="函数头"><a href="#函数头" class="headerlink" title="函数头"></a>函数头</h4><blockquote>
<p>短函数用名字比注释好</p>
</blockquote>
<h4 id="范例"><a href="#范例" class="headerlink" title="范例"></a>范例</h4><h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><blockquote>
<p>参照ESLint即可</p>
</blockquote>
<h2 id="对象和数据结构"><a href="#对象和数据结构" class="headerlink" title="对象和数据结构"></a>对象和数据结构</h2><h3 id="得墨忒耳律"><a href="#得墨忒耳律" class="headerlink" title="得墨忒耳律"></a>得墨忒耳律</h3><blockquote>
<p>模块不应了解它所操作对象的内部情形</p>
</blockquote>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><h3 id="使用异常而非错误码"><a href="#使用异常而非错误码" class="headerlink" title="使用异常而非错误码"></a>使用异常而非错误码</h3><blockquote>
<p>使用错误码要求调用者即刻检查错误</p>
<p>最好独立抽离出异常函数</p>
</blockquote>
<h3 id="别返回-传递null值"><a href="#别返回-传递null值" class="headerlink" title="别返回/传递null值"></a>别返回/传递null值</h3><h2 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h2><blockquote>
<p>简单设计的四条规则：</p>
<ol>
<li>运行所有测试</li>
<li>不可重复</li>
<li>表达了程序员的意图</li>
<li>尽可能减少类和方法的数量</li>
</ol>
</blockquote>
<h3 id="规则1：运行所有测试"><a href="#规则1：运行所有测试" class="headerlink" title="规则1：运行所有测试"></a>规则1：运行所有测试</h3><blockquote>
<p>代码耦合度越低、内聚度越高就越好测试</p>
<p>遵循有关编写测试并持续运行测试的简单、明确的规则，系统就会更贴近OO低耦合度、高内聚的目标</p>
</blockquote>
<h3 id="规则2-3：重构"><a href="#规则2-3：重构" class="headerlink" title="规则2-3：重构"></a>规则2-3：重构</h3><blockquote>
<p>在测试的基础上，重构就更容易了，因为消除了对破坏代码的恐惧</p>
</blockquote>
<h3 id="不可重复"><a href="#不可重复" class="headerlink" title="不可重复"></a>不可重复</h3><blockquote>
<p>用模板方法模式消除高层级重复</p>
</blockquote>
<h3 id="表达力"><a href="#表达力" class="headerlink" title="表达力"></a>表达力</h3><blockquote>
<p>选用好的名称</p>
</blockquote>
<h3 id="尽可能少的类和方法"><a href="#尽可能少的类和方法" class="headerlink" title="尽可能少的类和方法"></a>尽可能少的类和方法</h3><blockquote>
<p>在以上三条的基础上，才是这一条</p>
</blockquote>
<h3 id="使用异常代替返回错误码-1"><a href="#使用异常代替返回错误码-1" class="headerlink" title="使用异常代替返回错误码"></a>使用异常代替返回错误码</h3><blockquote>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-design/" rel="tag">web-design</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-webpack优化"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/02/23/webpack%E4%BC%98%E5%8C%96/"
    >webpack优化</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/02/23/webpack%E4%BC%98%E5%8C%96/" class="article-date">
  <time datetime="2021-02-23T08:24:29.000Z" itemprop="datePublished">2021-02-23</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/web-Design/">web-Design</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="webpack优化"><a href="#webpack优化" class="headerlink" title="webpack优化"></a>webpack优化</h1><p>因为前端项目打包时间实在是太久了，而且由于太大了，每次都会把服务器搞宕机，看了一下webpack的教程，来解决一下打包问题。</p>
<h2 id="小试牛刀-thread-loader"><a href="#小试牛刀-thread-loader" class="headerlink" title="小试牛刀(thread-loader)"></a>小试牛刀(thread-loader)</h2><p>肯定不会用现在的版本去测试，于是用个人项目<code>vue-template</code>去测试</p>
<p>先上猛料，看看==多线程打包==如何，只能说差强人意吧</p>
<p><img src="/2021/02/23/webpack%E4%BC%98%E5%8C%96/1.jpg"></p>
<p>还有因为这是vue-cli脚手架形成的，里面的配置项眼花缭乱，只能步步为营</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 安装</span></span><br><span class="line">cnpm i thread-loader -D</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改配置项</span></span><br><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        use: [<span class="string">&#x27;thread-loader&#x27;</span>,&#123;</span><br><span class="line">          loader:<span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;options&#x27;</span>: &#123;</span><br><span class="line">            <span class="comment">// 第二次构建时会读取之前的缓存</span></span><br><span class="line">            cacheDirectory: <span class="literal">true</span> <span class="comment">// 加了这个并没有明显感到加快</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        ],</span><br><span class="line">        <span class="comment">// loader: [&#x27;thread-loader&#x27;,&#x27;babel-loader&#x27;],</span></span><br><span class="line">        include: [resolve(<span class="string">&#x27;src&#x27;</span>), resolve(<span class="string">&#x27;test&#x27;</span>), resolve(<span class="string">&#x27;node_modules/webpack-dev-server/client&#x27;</span>)],</span><br><span class="line">        </span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>



<h2 id="深入探究-speed-measure-webpack-plugin-webpack-bundle-analyzer"><a href="#深入探究-speed-measure-webpack-plugin-webpack-bundle-analyzer" class="headerlink" title="深入探究(speed-measure-webpack-plugin/webpack-bundle-analyzer)"></a>深入探究(speed-measure-webpack-plugin/webpack-bundle-analyzer)</h2><h3 id="speed-measure-webpack-plugin"><a href="#speed-measure-webpack-plugin" class="headerlink" title="speed-measure-webpack-plugin"></a>speed-measure-webpack-plugin</h3><blockquote>
<p>使用speed-measure-webpack-plugin来查看各模块用时</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cnpm install --save-dev speed-measure-webpack-plugin <span class="comment">// 首先安装</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在webpack文件内创建对象</span></span><br><span class="line"><span class="keyword">const</span> SpeedMeasurePlugin = <span class="built_in">require</span>(<span class="string">&#x27;speed-measure-webpack-plugin&#x27;</span>); <span class="comment">//引入插件</span></span><br><span class="line"><span class="keyword">const</span> smp = <span class="keyword">new</span> SpeedMeasurePlugin(); <span class="comment">//创建插件对象</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = smp.wrap(&#123; <span class="comment">// 用smp.wrap包注export</span></span><br><span class="line">  context: path.resolve(__dirname, <span class="string">&#x27;../&#x27;</span>),</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: <span class="string">&#x27;./src/main.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="/2021/02/23/webpack%E4%BC%98%E5%8C%96/2.jpg"></p>
<p>可以看到都是老大哥了，用时都超过1000ms</p>
<h3 id="webpack-bundle-analyzer"><a href="#webpack-bundle-analyzer" class="headerlink" title="webpack-bundle-analyzer"></a>webpack-bundle-analyzer</h3><blockquote>
<p>通过webpack-bundle-analyzer可以看到各个包的体积</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cnpm install --save-dev webpack-bundle-analyzer</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; BundleAnalyzerPlugin &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack-bundle-analyzer&#x27;</span>);</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> BundleAnalyzerPlugin()</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<p><img src="/2021/02/23/webpack%E4%BC%98%E5%8C%96/3.jpg"></p>
<p>可以发现echarts和element-ui占用的量最大，可以考虑用cdn来减少打包体积</p>
<h2 id="dll打包-大大加快"><a href="#dll打包-大大加快" class="headerlink" title="dll打包(大大加快)"></a>dll打包(大大加快)</h2><blockquote>
<p>根据打包体积的输出，可以看到主要有echarts、element-ui等包体积过大，于是准备用dll来加速打包过程</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">cnpm install add-asset-html-webpack-plugin@<span class="number">2.1</span><span class="number">.2</span> <span class="comment">// 安装插件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在build文件夹下创建新文件webpack.dll.conf.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line">		<span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line">		<span class="built_in">module</span>.exports = &#123;</span><br><span class="line">		  entry: &#123;</span><br><span class="line">		    vendor: [</span><br><span class="line">		      <span class="string">&#x27;vue&#x27;</span>,</span><br><span class="line">		      <span class="string">&#x27;vue-router&#x27;</span>,</span><br><span class="line">		      <span class="string">&#x27;element-ui&#x27;</span>,</span><br><span class="line">		      <span class="string">&#x27;xxxxxxx&#x27;</span>      <span class="comment">//这里是需要缓存的模块和插件</span></span><br><span class="line">		    ]</span><br><span class="line">		  &#125;,</span><br><span class="line">		  output: &#123;</span><br><span class="line">		    path: path.join(__dirname, <span class="string">&#x27;../static/js&#x27;</span>), <span class="comment">//放在项目的static/js目录下面</span></span><br><span class="line">		    filename: <span class="string">&#x27;[name].dll.js&#x27;</span>, <span class="comment">//打包文件的名字</span></span><br><span class="line">		    library: <span class="string">&#x27;[name]_library&#x27;</span> <span class="comment">//可选 暴露出的全局变量名</span></span><br><span class="line">		    <span class="comment">// vendor.dll.js中暴露出的全局变量名。</span></span><br><span class="line">		    <span class="comment">// 主要是给DllPlugin中的name使用，</span></span><br><span class="line">		    <span class="comment">// 故这里需要和webpack.DllPlugin中的`name: &#x27;[name]_library&#x27;,`保持一致。</span></span><br><span class="line">		  &#125;,</span><br><span class="line">		  plugins: [</span><br><span class="line">		    <span class="keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">		      path: path.join(__dirname, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;[name]-manifest.json&#x27;</span>), <span class="comment">//生成上文说到清单文件，放在当前build文件下面，这个看你自己想放哪里了。</span></span><br><span class="line">		      name: <span class="string">&#x27;[name]_library&#x27;</span>,</span><br><span class="line">		    &#125;),</span><br><span class="line">		  ]</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在webpack.prod.conf.js下添加以下代码</span></span><br><span class="line"><span class="keyword">const</span> AddAssetHtmlPlugin = <span class="built_in">require</span>(<span class="string">&#x27;add-asset-html-webpack-plugin&#x27;</span>);  <span class="comment">//在上面导入</span></span><br><span class="line">   <span class="keyword">new</span> webpack.DllReferencePlugin(&#123; <span class="comment">// 这是放在plugins里面的</span></span><br><span class="line">				context: path.resolve(__dirname, <span class="string">&#x27;..&#x27;</span>),</span><br><span class="line">				manifest: <span class="built_in">require</span>(<span class="string">&#x27;./vendor-manifest.json&#x27;</span>)</span><br><span class="line">				&#125;),</span><br><span class="line">				<span class="comment">//这个主要是将生成的vendor.dll.js文件加上hash值插入到页面中。</span></span><br><span class="line">				<span class="keyword">new</span> AddAssetHtmlPlugin([&#123;</span><br><span class="line">				filepath: path.resolve(__dirname, <span class="string">&#x27;../static/js/vendor.dll.js&#x27;</span>),</span><br><span class="line">				outputPath: utils.assetsPath(<span class="string">&#x27;js&#x27;</span>),</span><br><span class="line">				publicPath: path.posix.join(config.build.assetsPublicPath, <span class="string">&#x27;static/js&#x27;</span>),</span><br><span class="line">				includeSourcemap: <span class="literal">false</span>,</span><br><span class="line">				hash: <span class="literal">true</span>,</span><br><span class="line">				&#125;]),</span><br><span class="line">       </span><br><span class="line"><span class="comment">// 在package.json里面添加指令</span></span><br><span class="line"><span class="string">&quot;dll&quot;</span>: <span class="string">&quot;webpack --config build/webpack.dll.conf.js&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 运行生成dll文件</span></span><br><span class="line">cnpm run dll</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打包</span></span><br><span class="line">cnpm run build</span><br></pre></td></tr></table></figure>

<p>可以看到打包速度大大增加</p>
<p><img src="/2021/02/23/webpack%E4%BC%98%E5%8C%96/4.jpg"></p>
<h3 id="一个大坑-element-ui"><a href="#一个大坑-element-ui" class="headerlink" title="一个大坑(element-ui)"></a>一个大坑(element-ui)</h3><blockquote>
<p>在线上项目也改过后，发现element-ui的图表老是显示不出来，关掉打包加速发现正常了。把dll加速里面的element-ui移除发现正常了，在网上搜索一番后，element-ui部分决定不使用dll加速，应该使用cdn加速，具体配置如下</p>
</blockquote>
<p>webpack.base.conf.js</p>
<p><img src="/2021/02/23/webpack%E4%BC%98%E5%8C%96/5.jpg"></p>
<p>项目根目录下index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/element-ui/2.14.1/theme-chalk/index.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/vue/2.5.2/vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/element-ui/2.14.1/index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"> Vue.config.productionTip=<span class="literal">false</span> </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/02/23/webpack%E4%BC%98%E5%8C%96/6.jpg"></p>
<p>webpack.dll.conf.js</p>
<p><img src="/2021/02/23/webpack%E4%BC%98%E5%8C%96/7.jpg"></p>
<p>main.js:注释掉element-ui部分</p>
<p><img src="/2021/02/23/webpack%E4%BC%98%E5%8C%96/8.jpg"></p>
<p>配置完成</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-design/" rel="tag">web-design</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-webpack"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/02/23/webpack/"
    >webpack</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/02/23/webpack/" class="article-date">
  <time datetime="2021-02-23T00:52:40.000Z" itemprop="datePublished">2021-02-23</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/web-Design/">web-Design</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h1><blockquote>
<p>Webpack是一种前端构建工具，一种静态模块打包器</p>
<p>Webpack可以将浏览器不能识别的代码转化为浏览器可以识别的代码，如scss/less转化为css</p>
</blockquote>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ol>
<li>webpack以入口文件为入口形成<code>依赖关系图</code></li>
<li>然后根据依赖关系图依次将相应资源引进形成<code>chunk</code>(代码块)</li>
<li>chunk里面的less/scss转化为css，js转化为浏览器可以识别的js等，这个过程叫<code>打包</code></li>
<li>打包输出的东西叫<code>bundle</code></li>
</ol>
<h3 id="五个核心概念"><a href="#五个核心概念" class="headerlink" title="五个核心概念"></a>五个核心概念</h3><h4 id="Entry-入口"><a href="#Entry-入口" class="headerlink" title="Entry(入口)"></a>Entry(入口)</h4><p>指示webpack以哪个文件为入口起点开始打包，分析构建内部依赖图</p>
<h4 id="Output-输出"><a href="#Output-输出" class="headerlink" title="Output(输出)"></a>Output(输出)</h4><p>指示webpack打包后的bundle输出到哪以及如何命名</p>
<h4 id="Loader-翻译器"><a href="#Loader-翻译器" class="headerlink" title="Loader(翻译器)"></a>Loader(翻译器)</h4><p>Loader让webpack能够去处理非js文件(webpack本身只理解js)</p>
<h4 id="Plugins-插件"><a href="#Plugins-插件" class="headerlink" title="Plugins(插件)"></a>Plugins(插件)</h4><p>可以用于执行更广的任务，包括打包优化和压缩、一直到重新定义环境中的变量等</p>
<h4 id="Mode-模式"><a href="#Mode-模式" class="headerlink" title="Mode(模式)"></a>Mode(模式)</h4><p>指示webpack使用相应模式的配置</p>
<p>如<code>development</code>或者<code>production</code></p>
<h2 id="DevServer-开发服务器"><a href="#DevServer-开发服务器" class="headerlink" title="DevServer(开发服务器)"></a>DevServer(开发服务器)</h2><blockquote>
<p>用来自动化(自动编译、打开浏览器、刷新浏览器等)</p>
<p>特点：只会在内存中编译打包，不会有任何输出</p>
<p>启动指令为：npx webpack-dev-server</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    <span class="comment">// 项目构建后目录</span></span><br><span class="line">	contentBase: resolve(_dirname, <span class="string">&#x27;build),</span></span><br><span class="line"><span class="string">	// 启动gzip压缩</span></span><br><span class="line"><span class="string">	compress: true,</span></span><br><span class="line"><span class="string">	port: 3000</span></span><br><span class="line"><span class="string">    // 自动打开浏览器</span></span><br><span class="line"><span class="string">    open: true</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="css"><a href="#css" class="headerlink" title="css"></a>css</h3><h4 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h4><blockquote>
<p>postcss –&gt; postcss-loader –&gt;postcss-preset-env</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;browserslist&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;development&quot;</span>: [ <span class="comment">// 开发</span></span><br><span class="line">        <span class="string">&quot;last 1 chrome version&quot;</span>,</span><br><span class="line">        <span class="string">&quot;last 1 firefox version&quot;</span>,</span><br><span class="line">        <span class="string">&quot;last 1 safari version&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;production&quot;</span>: [ <span class="comment">// 生产</span></span><br><span class="line">        <span class="string">&quot;&gt;0.2%&quot;</span>,</span><br><span class="line">        <span class="string">&quot;not dead&quot;</span>,</span><br><span class="line">        <span class="string">&quot;not op_mini all&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="js"><a href="#js" class="headerlink" title="js"></a>js</h3><h4 id="eslint代码检查"><a href="#eslint代码检查" class="headerlink" title="eslint代码检查"></a>eslint代码检查</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="string">&quot;eslintConfig&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;extends&quot;</span>: <span class="string">&quot;airbnb-base&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	<span class="built_in">module</span>: &#123;</span><br><span class="line">		rules: [</span><br><span class="line">			<span class="comment">// 语法检查: eslint-loader eslint</span></span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\/js$/</span>,</span><br><span class="line">                exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">                loader: <span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    <span class="comment">// 自动修复eslint错误</span></span><br><span class="line">                    fix: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="兼容性处理"><a href="#兼容性处理" class="headerlink" title="兼容性处理"></a>兼容性处理</h4><blockquote>
<p>babel-loader</p>
</blockquote>
<h3 id="压缩html和js"><a href="#压缩html和js" class="headerlink" title="压缩html和js"></a>压缩html和js</h3><p>生产环境</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HTMLWebpackPlugin(&#123;</span><br><span class="line">            <span class="comment">// 移除空格</span></span><br><span class="line">            collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">            <span class="comment">// 移除注释</span></span><br><span class="line">            removeComments: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="生产环境基本配置"><a href="#生产环境基本配置" class="headerlink" title="生产环境基本配置"></a>生产环境基本配置</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> OptimizeCssAssetsWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义nodejs环境变量：决定使用browserslist的哪个环境</span></span><br><span class="line">process.env.NODE_ENV = <span class="string">&#x27;production&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复用loader</span></span><br><span class="line"><span class="keyword">const</span> commonCssLoader = [</span><br><span class="line">  MiniCssExtractPlugin.loader,</span><br><span class="line">  <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// 还需要在package.json中定义browserslist</span></span><br><span class="line">    loader: <span class="string">&#x27;postcss-loader&#x27;</span>,</span><br><span class="line">    options: &#123;</span><br><span class="line">      ident: <span class="string">&#x27;postcss&#x27;</span>,</span><br><span class="line">      plugins: <span class="function">() =&gt;</span> [<span class="built_in">require</span>(<span class="string">&#x27;postcss-preset-env&#x27;</span>)()]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">&#x27;./src/js/index.js&#x27;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&#x27;js/built.js&#x27;</span>,</span><br><span class="line">    path: resolve(__dirname, <span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [...commonCssLoader]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [...commonCssLoader, <span class="string">&#x27;less-loader&#x27;</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">        正常来讲，一个文件只能被一个loader处理。</span></span><br><span class="line"><span class="comment">        当一个文件要被多个loader处理，那么一定要指定loader执行的先后顺序：</span></span><br><span class="line"><span class="comment">          先执行eslint 在执行babel</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 在package.json中eslintConfig --&gt; airbnb</span></span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="comment">// 优先执行</span></span><br><span class="line">        enforce: <span class="string">&#x27;pre&#x27;</span>,</span><br><span class="line">        loader: <span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          fix: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          presets: [</span><br><span class="line">            [</span><br><span class="line">              <span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">              &#123;</span><br><span class="line">                useBuiltIns: <span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">                corejs: &#123;<span class="attr">version</span>: <span class="number">3</span>&#125;,</span><br><span class="line">                targets: &#123;</span><br><span class="line">                  chrome: <span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">                  firefox: <span class="string">&#x27;50&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(jpg|png|gif)/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">8</span> * <span class="number">1024</span>,</span><br><span class="line">          name: <span class="string">&#x27;[hash:10].[ext]&#x27;</span>,</span><br><span class="line">          outputPath: <span class="string">&#x27;imgs&#x27;</span>,</span><br><span class="line">          esModule: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.html$/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        exclude: <span class="regexp">/\.(js|css|less|html|jpg|png|gif)/</span>,</span><br><span class="line">        loader: <span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          outputPath: <span class="string">&#x27;media&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: <span class="string">&#x27;css/built.css&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> OptimizeCssAssetsWebpackPlugin(),</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: <span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">        removeComments: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: <span class="string">&#x27;production&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><h3 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h3><h4 id="优化打包构建速度-HMR"><a href="#优化打包构建速度-HMR" class="headerlink" title="优化打包构建速度(HMR)"></a>优化打包构建速度(HMR)</h4><blockquote>
<p>默认修改单一模块，所有模块都要重新打包，所以需要HMR(hot module replacement 热模块替换)</p>
<p>HMR：一个模块变化，只会重新打包这个模块</p>
</blockquote>
<p>作用范围：</p>
<ol>
<li>样式文件，可以使用HMR，因为style-loader内部实现了</li>
<li>js，默认不能使用HMR</li>
<li>html，默认不能使用。解决：修改entry入口，将html文件引入</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">entry: [<span class="string">&#x27;./src/index.js&#x27;</span>, <span class="string">&#x27;./src/index.html&#x27;</span>]</span><br><span class="line">devServer: &#123;</span><br><span class="line">	<span class="comment">// 打开HMR</span></span><br><span class="line">	hot: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="优化代码调试-souce-map"><a href="#优化代码调试-souce-map" class="headerlink" title="优化代码调试(souce-map)"></a>优化代码调试(souce-map)</h4><blockquote>
<p>soucemap是一种提供源代码到构建后代码映射技术，可以追踪源代码，精确到错误行和列</p>
</blockquote>
<p>soucemap类别:</p>
<ol>
<li>inline-source-map:只生成一个内联sourcemap，提示错误代码准确信息和错误行</li>
<li>hidden-souce-map: 外部，提示错误代码原因，但是没有错误位置，不能追踪到源代码错误，只提示构建后代码错误位置</li>
<li>eval-souce-map: 内联，每个文件都声称对应的source-map，有错误提示和错误行</li>
<li>nosource-source-map：外部，有错误信息，但是没有任何源代码信息</li>
<li>cheap-source-map：外部，错误代码准确信息和错误行，只能精确到行</li>
<li>cheap-module-source-map：外部，错误代码准确信息和错误行</li>
</ol>
<p>内联和外部的区别：</p>
<ol>
<li>外部生成了文件，内联没有</li>
<li>内联构建速度更快</li>
</ol>
<p>开发环境：速度快，调式更友好</p>
<p>​    速度快(eval&gt;inline&gt;cheap&gt;…),最快：eval-cheap-source-map</p>
<p>​    调试更友好：source-map &gt; cheap-module-souce-map &gt; cheap-source-map</p>
<p>​    综合推荐：eval-souce-map</p>
<p>生产环境：源代码要不要隐藏？调试要不要更友好？</p>
<p>​    综合推荐: source-map</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devtool: <span class="string">&#x27;souce-map&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="生产环境"><a href="#生产环境" class="headerlink" title="生产环境"></a>生产环境</h3><h4 id="优化打包构建速度"><a href="#优化打包构建速度" class="headerlink" title="优化打包构建速度"></a>优化打包构建速度</h4><h5 id="oneOf"><a href="#oneOf" class="headerlink" title="oneOf"></a>oneOf</h5><blockquote>
<p>在oneOf里面的loader只会匹配一个，里面不能有两个配置处理同一个类型文件</p>
</blockquote>
<p>webpack原本的loader是将每个文件都过一遍，比如有一个js文件 rules中有10个loader，第一个是处理js文件的loader，当第一个loader处理完成后webpack不会自动跳出，而是会继续拿着这个js文件去尝试匹配剩下的9个loader，相当于没有break。<br>而oneOf就相当于这个break</p>
<h5 id="babel缓存"><a href="#babel缓存" class="headerlink" title="babel缓存"></a>babel缓存</h5><blockquote>
<p>因为js里面不支持HMR，每次都得重新编译，但是如果使用babel缓存的话就可以类似HMR</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">	...,</span><br><span class="line">	options: &#123;</span><br><span class="line">		<span class="comment">// 第二次构建时会读取之前的缓存</span></span><br><span class="line">		cacheDirectory: <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="多进程打包"><a href="#多进程打包" class="headerlink" title="多进程打包"></a>多进程打包</h5><blockquote>
<p>一般给babel用，有利有弊</p>
<p>因为进程启动大概为600ms，进程通信也要占用开销</p>
<p>只有工作消耗时间比较长，才需要多进程打包</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    use: [</span><br><span class="line">        <span class="comment">// 开启多进程打包</span></span><br><span class="line">        &#123;</span><br><span class="line">            loader:<span class="string">&#x27;thread-loader&#x27;</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">                worksers: <span class="number">2</span> <span class="comment">// 进程两个，一般来说只放上面的就行</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            ...其他配置项</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="external"><a href="#external" class="headerlink" title="external"></a>external</h5><blockquote>
<p>指定某些依赖不打包，需要手动引入cdn</p>
</blockquote>
<h5 id="dll"><a href="#dll" class="headerlink" title="dll"></a>dll</h5><blockquote>
<p>使用dll技术，对某些库(jquery, react, vue)进行单独打包</p>
</blockquote>
<h4 id="优化代码运行的性能"><a href="#优化代码运行的性能" class="headerlink" title="优化代码运行的性能"></a>优化代码运行的性能</h4><h5 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h5><h5 id="tree-shaking"><a href="#tree-shaking" class="headerlink" title="tree shaking"></a>tree shaking</h5><blockquote>
<p>树摇：去除应用程序中没有运行的代码</p>
<p>前提：1. 必须使用ES6模块化、2.开启production就会自动启用树摇</p>
</blockquote>
<h5 id="code-split-代码分割"><a href="#code-split-代码分割" class="headerlink" title="code split(代码分割)"></a>code split(代码分割)</h5><h6 id="多入口-不推荐"><a href="#多入口-不推荐" class="headerlink" title="多入口(不推荐)"></a>多入口(不推荐)</h6><p>多入口：输出多个bundle</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">    main: <span class="string">&#x27;./src..&#x27;</span>,</span><br><span class="line">    test: <span class="string">&#x27;./src...&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="单入口-推荐"><a href="#单入口-推荐" class="headerlink" title="单入口(推荐)"></a>单入口(推荐)</h6><ol>
<li>将node_modules打包成单独的chunk</li>
<li>自动分析多入口chunk中，有没有公共文件，如果有就单独打包成一个chunk</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">	splitChunks: &#123;</span><br><span class="line">		chunks: <span class="string">&#x27;all&#x27;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="懒加载-预加载"><a href="#懒加载-预加载" class="headerlink" title="懒加载/预加载"></a>懒加载/预加载</h5><h5 id="pwa"><a href="#pwa" class="headerlink" title="pwa"></a>pwa</h5><blockquote>
<p>pwa：让网页像应用程序一样可以离线访问</p>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-design/" rel="tag">web-design</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-查杀病毒xmrig"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/02/22/%E6%9F%A5%E6%9D%80%E7%97%85%E6%AF%92xmrig/"
    >查杀病毒xmrig</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/02/22/%E6%9F%A5%E6%9D%80%E7%97%85%E6%AF%92xmrig/" class="article-date">
  <time datetime="2021-02-22T13:25:47.000Z" itemprop="datePublished">2021-02-22</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/devOps/">devOps</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="记一次查杀病毒XMRIG"><a href="#记一次查杀病毒XMRIG" class="headerlink" title="记一次查杀病毒XMRIG"></a>记一次查杀病毒XMRIG</h1><p>首先总结一下：这是一次因为Jenkins漏洞出现的病毒，在Jenkins运行过程中会运行脚本病毒，导致每次运行Jenkins的workspace里面的程序CPU都会卡炸</p>
<p>以下为过程：</p>
<h2 id="寻找问题"><a href="#寻找问题" class="headerlink" title="寻找问题"></a>寻找问题</h2><p>在傍晚时分，前端突然找我说是Jenkins部署不了，我试着登陆了一下果然不行，转而去登陆服务器，发现已经死机了</p>
<p>重启服务器后马上使用<code>top</code>指令，发现有一个进程的名字不曾见过，名叫<code>xmrig</code></p>
<p>百度了一下，发现是一个挖矿软件，锁定目标</p>
<p>除此之外还发现一个现象，Jenkins里面多了一个项目，虽然不知道哪里来的</p>
<p>但是在其他博客里面也发现会多一个项目，于是删之</p>
<p>也没忘了在Jenkins的workspace也删之</p>
<p>也排查了一下crontab，没发现里面有被入侵的痕迹，都是正常的脚本</p>
<h2 id="找到罪魁祸首"><a href="#找到罪魁祸首" class="headerlink" title="找到罪魁祸首"></a>找到罪魁祸首</h2><p>通过<code>ps -ef | grep xmrig </code>  指令找到了罪魁祸首</p>
<p><img src="/2021/02/22/%E6%9F%A5%E6%9D%80%E7%97%85%E6%AF%92xmrig/1.jpg"></p>
<p>于是马上去<code>/root/c3pool/xmrig</code>目录下，果然发现了罪魁祸首，还明目张胆的叫miner，真是**呢，看了里面的代码比较简单</p>
<p><img src="/2021/02/22/%E6%9F%A5%E6%9D%80%E7%97%85%E6%AF%92xmrig/2.jpg"></p>
<p>删除里面的文件，留了个心眼，不删除外部的文件，将c3pool文件夹用<code>sudo chmod 000 c3pool</code>指令锁了</p>
<p>如果没有对应的处理代码，下次可能会被堵住</p>
<h2 id="柳暗花明"><a href="#柳暗花明" class="headerlink" title="柳暗花明"></a>柳暗花明</h2><p>后来再次在workspace里面运行代码，发现还是会卡死，问题还是没解决</p>
<p>在别的文件夹拉了代码运行，发现没问题，分析应该是Jenkins顺带运行了病毒脚本</p>
<p>于是只能使用全局查找<code>sudo find / -name xmrig</code>,发现在/var/log/jenkins/tmpst/xmrig-5.11.1/xmrig里面还遗留着代码</p>
<p>前面以为是log里面的没有问题，遂将其删除</p>
<p>用相同的手法，删除文件，将文件夹设为000权限</p>
<p>终于，问题解决了，后端部署没问题了</p>
<h2 id="问题依旧"><a href="#问题依旧" class="headerlink" title="问题依旧"></a>问题依旧</h2><p>但是在部署前端的时候还是有问题，还是会卡死。不能说惨不忍睹，只能说不忍直视。每次失败都要重启服务器，因为都会卡死</p>
<p><img src="/2021/02/22/%E6%9F%A5%E6%9D%80%E7%97%85%E6%AF%92xmrig/3.jpg"></p>
<p>接下来难以直接排查，于是只能自己手动部署一遍看看问题出在哪，不过依照进程来看应该是build阶段出的问题</p>
<p>手动<code>cnpm run build</code>，果然卡死了，百度了一下确实打包时间太久了，得优化webpack的打包</p>
<p>等过些时日学习一下webpack吧，看来这个问题并不是xmrig引起的…</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DevOps/" rel="tag">DevOps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Experience/" rel="tag">Experience</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-设计原则和编程技巧"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/02/21/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/"
    >设计原则和编程技巧</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/02/21/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/" class="article-date">
  <time datetime="2021-02-21T08:10:48.000Z" itemprop="datePublished">2021-02-21</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/PStudy/">PStudy</a> / <a class="article-category-link" href="/categories/PStudy/web-Design/">web-Design</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="设计原则和编程技巧"><a href="#设计原则和编程技巧" class="headerlink" title="设计原则和编程技巧"></a>设计原则和编程技巧</h1><p>取自《JavaScript设计模式与开发实践》</p>
<h2 id="单一职责原则-SRP"><a href="#单一职责原则-SRP" class="headerlink" title="单一职责原则(SRP)"></a>单一职责原则(SRP)</h2><p><strong>定义</strong>：引起一个方法改变的动机只能有一个，简而言之就是如果需要修改这个方法的内容，那样的动机只能有一个</p>
<p><strong>为什么？</strong>：如果一个方法承担了太多的职责，后期修改这个方法的可能性越大，也越难修改。是低内聚和高耦合的脆弱设计。</p>
<p><strong>什么时候？</strong>：并不是所有的职责都需要分离，以下情况可以不用着急分离</p>
<ol>
<li>如果随着需求的变化，有两个职责总是同时改变，那么就没必要分离他们，可以看作同一个职责</li>
<li>即使两个职责已经被耦合在一起，但他们还没有发生改变的征兆，可以等到重构但时候再分离也不迟</li>
</ol>
<p><strong>优点</strong>：降低单个类或者对象的复杂度</p>
<p><strong>缺点</strong>：增加代码的复杂度，分离后实际上也增加了对象之间相互联系的难度</p>
<h2 id="最少知识原则-LKP"><a href="#最少知识原则-LKP" class="headerlink" title="最少知识原则(LKP)"></a>最少知识原则(LKP)</h2><p><strong>定义</strong>：一个实体应该尽可能少的与其他实体发生相互作用。即应该减少对象之间的交互，常见的方法是引入第三者来转发</p>
<h2 id="开放-封闭原则-OCP"><a href="#开放-封闭原则-OCP" class="headerlink" title="开放-封闭原则(OCP)"></a>开放-封闭原则(OCP)</h2><p><strong>定义</strong>：实体应该是可以扩展的，但是不可修改</p>
<p><strong>思路</strong>：分离出代码中不可变和可变的地方，运用多态来动态使用他们</p>
<p><strong>怎么做</strong>：有些代码确实不能完全封闭，我们只能做到以下的点</p>
<ol>
<li>挑选出最容易发生变化的地方，然后构造抽象来封闭这些变化</li>
<li>在不可避免发生修改的时候，尽量修改那些容易修改的地方而不是选择难以修改</li>
</ol>
<h2 id="接口和面向接口编程"><a href="#接口和面向接口编程" class="headerlink" title="接口和面向接口编程"></a>接口和面向接口编程</h2><p><strong>思想</strong>：面向抽象编程而不是面向实现编程</p>
<h2 id="代码重构"><a href="#代码重构" class="headerlink" title="代码重构"></a>代码重构</h2><p>以下为重构的手段</p>
<h3 id="提炼函数"><a href="#提炼函数" class="headerlink" title="提炼函数"></a>提炼函数</h3><p>一个函数过长，需要将函数内的代码提炼出来，有以下好处：</p>
<ol>
<li>避免出现超大函数</li>
<li>独立出来的函数有助于代码复用</li>
<li>独立出来的函数更容易被覆写</li>
<li>独立出来的函数如果拥有一个良好的命名，本身就起到了注释的作用</li>
</ol>
<h3 id="合并重复的条件片段"><a href="#合并重复的条件片段" class="headerlink" title="合并重复的条件片段"></a>合并重复的条件片段</h3><h3 id="把条件分支语句提炼成函数"><a href="#把条件分支语句提炼成函数" class="headerlink" title="把条件分支语句提炼成函数"></a>把条件分支语句提炼成函数</h3><p>简而言之就是将长条件提炼成短函数，用函数的名称来当作注释，增加代码可读性</p>
<h3 id="提前让函数退出代替嵌套条件分支"><a href="#提前让函数退出代替嵌套条件分支" class="headerlink" title="提前让函数退出代替嵌套条件分支"></a>提前让函数退出代替嵌套条件分支</h3><p>没必要遵守“函数只有一个入口和出口的条件”，多个出口也未尝不好</p>
<h3 id="传递对象参数已代替过长的参数列表"><a href="#传递对象参数已代替过长的参数列表" class="headerlink" title="传递对象参数已代替过长的参数列表"></a>传递对象参数已代替过长的参数列表</h3><p><strong>在过长参数的函数中</strong>，以对象的竖序排列代替参数的横向排列以增加代码的可读性</p>
<h3 id="尽量减少参数数量"><a href="#尽量减少参数数量" class="headerlink" title="尽量减少参数数量"></a>尽量减少参数数量</h3><p>因为这样会使这个函数的复用率降低</p>
<h3 id="少用三目运算符"><a href="#少用三目运算符" class="headerlink" title="少用三目运算符"></a>少用三目运算符</h3><p>可读性太差了</p>
<h3 id="合理使用链式调用"><a href="#合理使用链式调用" class="headerlink" title="合理使用链式调用"></a>合理使用链式调用</h3><p>不要习惯于链式调用即类似new User().setId(123).setName(‘aaa’)</p>
<p>因为一旦出问题很难追踪错误</p>
<p>如果该链稳定的话无可厚非，但是如果很容易发生变化的话，建议使用普通调用模式</p>
<h3 id="用return退出多重循环"><a href="#用return退出多重循环" class="headerlink" title="用return退出多重循环"></a>用return退出多重循环</h3><p>因为用break的话可读性很差，很难分辨跳到哪一层循环了，而用return的话就很容易读懂</p>
<p>如果return以后还有要执行的内容，可以通过在外面声明函数，里面放要执行的代码</p>
<p>类似return thisFunction()的方式来执行最后的函数</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-design/" rel="tag">web-design</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2021
        <i class="ri-heart-fill heart_icon"></i> CDX
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        由 <a href="https://hexo.io" target="_blank">Hexo</a> 强力驱动
        <span class="division">|</span>
        主题 - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/Logo.svg" alt="CDX"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
  </div>
</body>

</html>